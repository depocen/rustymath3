<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Primer Math | Mathemathics and Statistics Bootcamp for Econonomics and Social Sciences</title>
  <meta name="description" content="Text modelled on for Harvard Department of Government Math Prefresher" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Primer Math | Mathemathics and Statistics Bootcamp for Econonomics and Social Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="./images/logo.png" />
  <meta property="og:description" content="Text modelled on for Harvard Department of Government Math Prefresher" />
  <meta name="github-repo" content="Rusty Math 3" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Primer Math | Mathemathics and Statistics Bootcamp for Econonomics and Social Sciences" />
  
  <meta name="twitter:description" content="Text modelled on for Harvard Department of Government Math Prefresher" />
  <meta name="twitter:image" content="./images/logo.png" />

<meta name="author" content="Nguyen Ngoc Anh" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="markov-chain-monte-carlo-methods.html"/>
<link rel="next" href="confidence-ellipse.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Gov Prefresher</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this Booklet</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors-and-contributors"><i class="fa fa-check"></i>Authors and Contributors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i>Contributing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html"><i class="fa fa-check"></i>R and All that</a><ul>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#linear-algebra"><i class="fa fa-check"></i>Linear Algebra</a><ul>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#vectors"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#matrices"><i class="fa fa-check"></i>Matrices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#operations"><i class="fa fa-check"></i>Operations</a><ul>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#summation"><i class="fa fa-check"></i>Summation</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#products"><i class="fa fa-check"></i>Products</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#logs-and-exponents"><i class="fa fa-check"></i>Logs and exponents</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#limits"><i class="fa fa-check"></i>Limits</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#calculus"><i class="fa fa-check"></i>Calculus</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#optimization"><i class="fa fa-check"></i>Optimization</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#probability"><i class="fa fa-check"></i>Probability</a><ul>
<li class="chapter" data-level="0.0.1" data-path="r-and-all-that.html"><a href="r-and-all-that.html#graphics"><i class="fa fa-check"></i><b>0.0.1</b> Graphics</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Math</b></span></li>
<li class="chapter" data-level="1" data-path="functions-and-operations.html"><a href="functions-and-operations.html"><i class="fa fa-check"></i><b>1</b> Functions and Operations</a><ul>
<li class="chapter" data-level="1.1" data-path="functions-and-operations.html"><a href="functions-and-operations.html#sum-notation"><i class="fa fa-check"></i><b>1.1</b> Summation Operators <span class="math inline">\(\sum\)</span> and <span class="math inline">\(\prod\)</span></a></li>
<li class="chapter" data-level="1.2" data-path="functions-and-operations.html"><a href="functions-and-operations.html#introduction-to-functions"><i class="fa fa-check"></i><b>1.2</b> Introduction to Functions</a></li>
<li class="chapter" data-level="1.3" data-path="functions-and-operations.html"><a href="functions-and-operations.html#logexponents"><i class="fa fa-check"></i><b>1.3</b> <span class="math inline">\(\log\)</span> and <span class="math inline">\(\exp\)</span></a></li>
<li class="chapter" data-level="1.4" data-path="functions-and-operations.html"><a href="functions-and-operations.html#graphing-functions"><i class="fa fa-check"></i><b>1.4</b> Graphing Functions</a></li>
<li class="chapter" data-level="1.5" data-path="functions-and-operations.html"><a href="functions-and-operations.html#solving-for-variables-and-finding-roots"><i class="fa fa-check"></i><b>1.5</b> Solving for Variables and Finding Roots</a></li>
<li class="chapter" data-level="1.6" data-path="functions-and-operations.html"><a href="functions-and-operations.html#sets"><i class="fa fa-check"></i><b>1.6</b> Sets</a></li>
<li class="chapter" data-level="" data-path="functions-and-operations.html"><a href="functions-and-operations.html#answers-to-examples-and-exercises"><i class="fa fa-check"></i>Answers to Examples and Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="limits-precalc.html"><a href="limits-precalc.html"><i class="fa fa-check"></i><b>2</b> Limits</a><ul>
<li class="chapter" data-level="" data-path="limits-precalc.html"><a href="limits-precalc.html#example-the-central-limit-theorem"><i class="fa fa-check"></i>Example: The Central Limit Theorem</a></li>
<li class="chapter" data-level="" data-path="limits-precalc.html"><a href="limits-precalc.html#example-the-law-of-large-numbers"><i class="fa fa-check"></i>Example: The Law of Large Numbers</a></li>
<li class="chapter" data-level="2.1" data-path="limits-precalc.html"><a href="limits-precalc.html#sequences"><i class="fa fa-check"></i><b>2.1</b> Sequences</a></li>
<li class="chapter" data-level="2.2" data-path="limits-precalc.html"><a href="limits-precalc.html#the-limit-of-a-sequence"><i class="fa fa-check"></i><b>2.2</b> The Limit of a Sequence</a></li>
<li class="chapter" data-level="2.3" data-path="limits-precalc.html"><a href="limits-precalc.html#limitsfun"><i class="fa fa-check"></i><b>2.3</b> Limits of a Function</a></li>
<li class="chapter" data-level="2.4" data-path="limits-precalc.html"><a href="limits-precalc.html#continuity"><i class="fa fa-check"></i><b>2.4</b> Continuity</a></li>
<li class="chapter" data-level="" data-path="limits-precalc.html"><a href="limits-precalc.html#answers-to-examples"><i class="fa fa-check"></i>Answers to Examples</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="derivatives.html"><a href="derivatives.html"><i class="fa fa-check"></i><b>3</b> Calculus</a><ul>
<li class="chapter" data-level="" data-path="derivatives.html"><a href="derivatives.html#example-the-mean-is-a-type-of-integral"><i class="fa fa-check"></i>Example: The Mean is a Type of Integral</a></li>
<li class="chapter" data-level="3.1" data-path="derivatives.html"><a href="derivatives.html#derivintro"><i class="fa fa-check"></i><b>3.1</b> Derivatives</a><ul>
<li class="chapter" data-level="" data-path="derivatives.html"><a href="derivatives.html#properties-of-derivatives"><i class="fa fa-check"></i>Properties of derivatives</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="derivatives.html"><a href="derivatives.html#derivpoly"><i class="fa fa-check"></i><b>3.2</b> Higher-Order Derivatives (Derivatives of Derivatives of Derivatives)</a></li>
<li class="chapter" data-level="3.3" data-path="derivatives.html"><a href="derivatives.html#composite-functions-and-the-chain-rule"><i class="fa fa-check"></i><b>3.3</b> Composite Functions and the Chain Rule</a></li>
<li class="chapter" data-level="3.4" data-path="derivatives.html"><a href="derivatives.html#derivatives-of-natural-logs-and-the-exponent"><i class="fa fa-check"></i><b>3.4</b> Derivatives of natural logs and the exponent</a><ul>
<li><a href="derivatives.html#derivatives-of-natural-exponential-function-e">Derivatives of natural exponential function (<span class="math inline">\(e\)</span>)</a></li>
<li><a href="derivatives.html#derivatives-of-log">Derivatives of <span class="math inline">\(\log\)</span></a></li>
<li class="chapter" data-level="" data-path="derivatives.html"><a href="derivatives.html#outline-of-proof"><i class="fa fa-check"></i>Outline of Proof</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="derivatives.html"><a href="derivatives.html#partial-derivatives"><i class="fa fa-check"></i><b>3.5</b> Partial Derivatives</a></li>
<li class="chapter" data-level="3.6" data-path="derivatives.html"><a href="derivatives.html#taylorapprox"><i class="fa fa-check"></i><b>3.6</b> Taylor Series Approximation</a></li>
<li class="chapter" data-level="3.7" data-path="derivatives.html"><a href="derivatives.html#the-indefinite-integration"><i class="fa fa-check"></i><b>3.7</b> The Indefinite Integration</a><ul>
<li class="chapter" data-level="" data-path="derivatives.html"><a href="derivatives.html#common-rules-of-integration"><i class="fa fa-check"></i>Common Rules of Integration</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="derivatives.html"><a href="derivatives.html#the-definite-integral-the-area-under-the-curve"><i class="fa fa-check"></i><b>3.8</b> The Definite Integral: The Area under the Curve</a><ul>
<li class="chapter" data-level="" data-path="derivatives.html"><a href="derivatives.html#common-rules-for-definite-integrals"><i class="fa fa-check"></i>Common Rules for Definite Integrals</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="derivatives.html"><a href="derivatives.html#integration-by-substitution"><i class="fa fa-check"></i><b>3.9</b> Integration by Substitution</a></li>
<li class="chapter" data-level="3.10" data-path="derivatives.html"><a href="derivatives.html#integration-by-parts"><i class="fa fa-check"></i><b>3.10</b> Integration by Parts</a></li>
<li class="chapter" data-level="" data-path="functions-and-operations.html"><a href="functions-and-operations.html#answers-to-examples-and-exercises"><i class="fa fa-check"></i>Answers to Examples and Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="optim.html"><a href="optim.html"><i class="fa fa-check"></i><b>4</b> Optimization</a><ul>
<li class="chapter" data-level="" data-path="optim.html"><a href="optim.html#example-meltzer-richard"><i class="fa fa-check"></i>Example: Meltzer-Richard</a></li>
<li class="chapter" data-level="4.1" data-path="optim.html"><a href="optim.html#maxima-and-minima"><i class="fa fa-check"></i><b>4.1</b> Maxima and Minima</a></li>
<li class="chapter" data-level="4.2" data-path="optim.html"><a href="optim.html#concavity-of-a-function"><i class="fa fa-check"></i><b>4.2</b> Concavity of a Function</a><ul>
<li class="chapter" data-level="" data-path="optim.html"><a href="optim.html#quadratic-forms"><i class="fa fa-check"></i>Quadratic Forms</a></li>
<li class="chapter" data-level="" data-path="optim.html"><a href="optim.html#definiteness-of-quadratic-forms"><i class="fa fa-check"></i>Definiteness of Quadratic Forms</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="optim.html"><a href="optim.html#foc-and-soc"><i class="fa fa-check"></i><b>4.3</b> FOC and SOC</a><ul>
<li class="chapter" data-level="" data-path="optim.html"><a href="optim.html#first-order-conditions"><i class="fa fa-check"></i>First Order Conditions</a></li>
<li class="chapter" data-level="" data-path="optim.html"><a href="optim.html#second-order-conditions"><i class="fa fa-check"></i>Second Order Conditions</a></li>
<li class="chapter" data-level="" data-path="optim.html"><a href="optim.html#definiteness-and-concavity"><i class="fa fa-check"></i>Definiteness and Concavity</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="optim.html"><a href="optim.html#global-maxima-and-minima"><i class="fa fa-check"></i><b>4.4</b> Global Maxima and Minima</a></li>
<li class="chapter" data-level="4.5" data-path="optim.html"><a href="optim.html#constrained-optimization"><i class="fa fa-check"></i><b>4.5</b> Constrained Optimization</a><ul>
<li class="chapter" data-level="" data-path="optim.html"><a href="optim.html#equality-constraints"><i class="fa fa-check"></i>Equality Constraints</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="optim.html"><a href="optim.html#inequality-constraints"><i class="fa fa-check"></i><b>4.6</b> Inequality Constraints</a></li>
<li class="chapter" data-level="4.7" data-path="optim.html"><a href="optim.html#kuhn-tucker-conditions"><i class="fa fa-check"></i><b>4.7</b> Kuhn-Tucker Conditions</a></li>
<li class="chapter" data-level="4.8" data-path="optim.html"><a href="optim.html#applications-of-quadratic-forms"><i class="fa fa-check"></i><b>4.8</b> Applications of Quadratic Forms</a></li>
<li class="chapter" data-level="4.9" data-path="optim.html"><a href="optim.html#numerics-numerical-computation"><i class="fa fa-check"></i><b>4.9</b> Numerics / Numerical computation</a><ul>
<li class="chapter" data-level="4.9.1" data-path="optim.html"><a href="optim.html#rounding-error"><i class="fa fa-check"></i><b>4.9.1</b> Rounding error</a></li>
<li class="chapter" data-level="4.9.2" data-path="optim.html"><a href="optim.html#computing-exp-x-avoiding-computing-large---large"><i class="fa fa-check"></i><b>4.9.2</b> 1.2 Computing exp (x): avoiding computing large - large</a></li>
<li class="chapter" data-level="4.9.3" data-path="optim.html"><a href="optim.html#univariate-optimization-for-mle"><i class="fa fa-check"></i><b>4.9.3</b> Univariate Optimization for MLE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="probability-theory.html"><a href="probability-theory.html"><i class="fa fa-check"></i><b>5</b> Probability Theory</a><ul>
<li class="chapter" data-level="5.1" data-path="probability-theory.html"><a href="probability-theory.html#counting-rules"><i class="fa fa-check"></i><b>5.1</b> Counting rules</a></li>
<li class="chapter" data-level="5.2" data-path="probability-theory.html"><a href="probability-theory.html#setoper"><i class="fa fa-check"></i><b>5.2</b> Sets</a></li>
<li class="chapter" data-level="5.3" data-path="probability-theory.html"><a href="probability-theory.html#probdef"><i class="fa fa-check"></i><b>5.3</b> Probability</a><ul>
<li class="chapter" data-level="" data-path="probability-theory.html"><a href="probability-theory.html#probability-definitions-formal-and-informal"><i class="fa fa-check"></i>Probability Definitions: Formal and Informal</a></li>
<li class="chapter" data-level="" data-path="probability-theory.html"><a href="probability-theory.html#probability-operations"><i class="fa fa-check"></i>Probability Operations</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="probability-theory.html"><a href="probability-theory.html#conditional-probability-and-bayes-rule"><i class="fa fa-check"></i><b>5.4</b> Conditional Probability and Bayes Rule</a></li>
<li class="chapter" data-level="5.5" data-path="probability-theory.html"><a href="probability-theory.html#independence"><i class="fa fa-check"></i><b>5.5</b> Independence</a></li>
<li class="chapter" data-level="5.6" data-path="probability-theory.html"><a href="probability-theory.html#random-variables"><i class="fa fa-check"></i><b>5.6</b> Random Variables</a></li>
<li class="chapter" data-level="5.7" data-path="probability-theory.html"><a href="probability-theory.html#distributions"><i class="fa fa-check"></i><b>5.7</b> Distributions</a><ul>
<li class="chapter" data-level="" data-path="probability-theory.html"><a href="probability-theory.html#discrete-random-variables"><i class="fa fa-check"></i>Discrete Random Variables</a></li>
<li class="chapter" data-level="" data-path="probability-theory.html"><a href="probability-theory.html#continuous-random-variables"><i class="fa fa-check"></i>Continuous Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="probability-theory.html"><a href="probability-theory.html#joint-distributions"><i class="fa fa-check"></i><b>5.8</b> Joint Distributions</a></li>
<li class="chapter" data-level="5.9" data-path="probability-theory.html"><a href="probability-theory.html#expectation"><i class="fa fa-check"></i><b>5.9</b> Expectation</a><ul>
<li class="chapter" data-level="" data-path="probability-theory.html"><a href="probability-theory.html#expected-value-of-a-function"><i class="fa fa-check"></i>Expected Value of a Function</a></li>
<li class="chapter" data-level="" data-path="probability-theory.html"><a href="probability-theory.html#properties-of-expected-values"><i class="fa fa-check"></i>Properties of Expected Values</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="probability-theory.html"><a href="probability-theory.html#variance-and-covariance"><i class="fa fa-check"></i><b>5.10</b> Variance and Covariance</a></li>
<li class="chapter" data-level="5.11" data-path="probability-theory.html"><a href="probability-theory.html#special-distributions"><i class="fa fa-check"></i><b>5.11</b> Special Distributions</a></li>
<li class="chapter" data-level="5.12" data-path="probability-theory.html"><a href="probability-theory.html#summarizing-observed-events-data"><i class="fa fa-check"></i><b>5.12</b> Summarizing Observed Events (Data)</a></li>
<li class="chapter" data-level="5.13" data-path="probability-theory.html"><a href="probability-theory.html#asymptotic-theory"><i class="fa fa-check"></i><b>5.13</b> Asymptotic Theory</a><ul>
<li class="chapter" data-level="5.13.1" data-path="probability-theory.html"><a href="probability-theory.html#clt-and-lln"><i class="fa fa-check"></i><b>5.13.1</b> CLT and LLN</a></li>
<li class="chapter" data-level="5.13.2" data-path="probability-theory.html"><a href="probability-theory.html#big-mathcalo-notation"><i class="fa fa-check"></i><b>5.13.2</b> Big <span class="math inline">\(\mathcal{O}\)</span> Notation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="functions-and-operations.html"><a href="functions-and-operations.html#answers-to-examples-and-exercises"><i class="fa fa-check"></i>Answers to Examples and Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linearalgebra.html"><a href="linearalgebra.html"><i class="fa fa-check"></i><b>6</b> Linear Algebra</a><ul>
<li class="chapter" data-level="6.1" data-path="linearalgebra.html"><a href="linearalgebra.html#vector-def"><i class="fa fa-check"></i><b>6.1</b> Working with Vectors</a></li>
<li class="chapter" data-level="6.2" data-path="linearalgebra.html"><a href="linearalgebra.html#linearindependence"><i class="fa fa-check"></i><b>6.2</b> Linear Independence</a></li>
<li class="chapter" data-level="6.3" data-path="linearalgebra.html"><a href="linearalgebra.html#matrixbasics"><i class="fa fa-check"></i><b>6.3</b> Basics of Matrix Algebra</a></li>
<li class="chapter" data-level="6.4" data-path="linearalgebra.html"><a href="linearalgebra.html#systems-of-linear-equations"><i class="fa fa-check"></i><b>6.4</b> Systems of Linear Equations</a></li>
<li class="chapter" data-level="6.5" data-path="linearalgebra.html"><a href="linearalgebra.html#systems-of-equations-as-matrices"><i class="fa fa-check"></i><b>6.5</b> Systems of Equations as Matrices</a></li>
<li class="chapter" data-level="6.6" data-path="linearalgebra.html"><a href="linearalgebra.html#finding-solutions-to-augmented-matrices-and-systems-of-equations"><i class="fa fa-check"></i><b>6.6</b> Finding Solutions to Augmented Matrices and Systems of Equations</a></li>
<li class="chapter" data-level="6.7" data-path="linearalgebra.html"><a href="linearalgebra.html#rank-and-whether-a-system-has-one-infinite-or-no-solutions"><i class="fa fa-check"></i><b>6.7</b> Rank — and Whether a System Has One, Infinite, or No Solutions</a></li>
<li class="chapter" data-level="6.8" data-path="linearalgebra.html"><a href="linearalgebra.html#the-inverse-of-a-matrix"><i class="fa fa-check"></i><b>6.8</b> The Inverse of a Matrix</a></li>
<li class="chapter" data-level="6.9" data-path="linearalgebra.html"><a href="linearalgebra.html#linear-systems-and-inverses"><i class="fa fa-check"></i><b>6.9</b> Linear Systems and Inverses</a></li>
<li class="chapter" data-level="6.10" data-path="linearalgebra.html"><a href="linearalgebra.html#determinants"><i class="fa fa-check"></i><b>6.10</b> Determinants</a></li>
<li class="chapter" data-level="6.11" data-path="linearalgebra.html"><a href="linearalgebra.html#getting-inverse-of-a-matrix-using-its-determinant"><i class="fa fa-check"></i><b>6.11</b> Getting Inverse of a Matrix using its Determinant</a></li>
<li class="chapter" data-level="" data-path="functions-and-operations.html"><a href="functions-and-operations.html#answers-to-examples-and-exercises"><i class="fa fa-check"></i>Answers to Examples and Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Programming</b></span></li>
<li class="chapter" data-level="7" data-path="dataimport.html"><a href="dataimport.html"><i class="fa fa-check"></i><b>7</b> Orientation and Reading in Data</a><ul>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#motivation-data-and-you"><i class="fa fa-check"></i>Motivation: Data and You</a><ul>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#where-are-we-where-are-we-headed"><i class="fa fa-check"></i>Where are we? Where are we headed?</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#check-your-understanding"><i class="fa fa-check"></i>Check your understanding</a></li>
</ul></li>
<li class="chapter" data-level="7.1" data-path="dataimport.html"><a href="dataimport.html#orienting"><i class="fa fa-check"></i><b>7.1</b> Orienting</a></li>
<li class="chapter" data-level="7.2" data-path="dataimport.html"><a href="dataimport.html#but-what-is-r"><i class="fa fa-check"></i><b>7.2</b> But what is R?</a></li>
<li class="chapter" data-level="7.3" data-path="dataimport.html"><a href="dataimport.html#the-computer-and-you-giving-instructions"><i class="fa fa-check"></i><b>7.3</b> The Computer and You: Giving Instructions</a></li>
<li class="chapter" data-level="7.4" data-path="dataimport.html"><a href="dataimport.html#base-r-vs.-tidyverse"><i class="fa fa-check"></i><b>7.4</b> Base-R vs. tidyverse</a><ul>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#dataframe-subsetting"><i class="fa fa-check"></i>Dataframe subsetting</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#read-data"><i class="fa fa-check"></i>Read data</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="dataimport.html"><a href="dataimport.html#a-is-for-athens"><i class="fa fa-check"></i><b>7.5</b> A is for Athens</a><ul>
<li class="chapter" data-level="7.5.1" data-path="dataimport.html"><a href="dataimport.html#locating-the-data"><i class="fa fa-check"></i><b>7.5.1</b> Locating the Data</a></li>
<li class="chapter" data-level="7.5.2" data-path="dataimport.html"><a href="dataimport.html#reading-in-data"><i class="fa fa-check"></i><b>7.5.2</b> Reading in Data</a></li>
<li class="chapter" data-level="7.5.3" data-path="dataimport.html"><a href="dataimport.html#inspecting"><i class="fa fa-check"></i><b>7.5.3</b> Inspecting</a></li>
<li class="chapter" data-level="7.5.4" data-path="dataimport.html"><a href="dataimport.html#finding-observations"><i class="fa fa-check"></i><b>7.5.4</b> Finding observations</a></li>
<li class="chapter" data-level="7.5.5" data-path="dataimport.html"><a href="dataimport.html#extra-a-sneak-peak-at-obers-data"><i class="fa fa-check"></i><b>7.5.5</b> Extra: A sneak peak at Ober’s data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section"><i class="fa fa-check"></i>1</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-1"><i class="fa fa-check"></i>2</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-2"><i class="fa fa-check"></i>3</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-3"><i class="fa fa-check"></i>4</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-4"><i class="fa fa-check"></i>5</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-5"><i class="fa fa-check"></i>6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rmatrices.html"><a href="rmatrices.html"><i class="fa fa-check"></i><b>8</b> Manipulating Vectors and Matrices</a><ul>
<li class="chapter" data-level="" data-path="rmatrices.html"><a href="rmatrices.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#where-are-we-where-are-we-headed"><i class="fa fa-check"></i>Where are we? Where are we headed?</a></li>
<li class="chapter" data-level="8.1" data-path="dataimport.html"><a href="dataimport.html#read-data"><i class="fa fa-check"></i><b>8.1</b> Read Data</a></li>
<li class="chapter" data-level="8.2" data-path="rmatrices.html"><a href="rmatrices.html#data.frame-vs.-matricies"><i class="fa fa-check"></i><b>8.2</b> data.frame vs. matricies</a></li>
<li class="chapter" data-level="8.3" data-path="rmatrices.html"><a href="rmatrices.html#handling-matricies-in-r"><i class="fa fa-check"></i><b>8.3</b> Handling matricies in <code>R</code></a></li>
<li class="chapter" data-level="8.4" data-path="rmatrices.html"><a href="rmatrices.html#variable-transformations"><i class="fa fa-check"></i><b>8.4</b> Variable Transformations</a></li>
<li class="chapter" data-level="8.5" data-path="rmatrices.html"><a href="rmatrices.html#linear-combinations"><i class="fa fa-check"></i><b>8.5</b> Linear Combinations</a></li>
<li class="chapter" data-level="8.6" data-path="rmatrices.html"><a href="rmatrices.html#matrix-basics"><i class="fa fa-check"></i><b>8.6</b> Matrix Basics</a></li>
<li class="chapter" data-level="" data-path="rmatrices.html"><a href="rmatrices.html#checkpoint"><i class="fa fa-check"></i>Checkpoint</a><ul>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section"><i class="fa fa-check"></i>1</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-1"><i class="fa fa-check"></i>2</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-2"><i class="fa fa-check"></i>3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-3"><i class="fa fa-check"></i>1</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-4"><i class="fa fa-check"></i>2</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-5"><i class="fa fa-check"></i>3</a></li>
<li class="chapter" data-level="" data-path="rmatrices.html"><a href="rmatrices.html#section-6"><i class="fa fa-check"></i>4</a></li>
<li class="chapter" data-level="" data-path="rmatrices.html"><a href="rmatrices.html#section-7"><i class="fa fa-check"></i>5</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="robjloops.html"><a href="robjloops.html"><i class="fa fa-check"></i><b>9</b> Objects, Functions, Loops</a><ul>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#where-are-we-where-are-we-headed"><i class="fa fa-check"></i>Where are we? Where are we headed?</a></li>
<li class="chapter" data-level="9.1" data-path="robjloops.html"><a href="robjloops.html#what-is-an-object"><i class="fa fa-check"></i><b>9.1</b> What is an object?</a><ul>
<li class="chapter" data-level="9.1.1" data-path="robjloops.html"><a href="robjloops.html#lists"><i class="fa fa-check"></i><b>9.1.1</b> lists</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="robjloops.html"><a href="robjloops.html#making-your-own-objects"><i class="fa fa-check"></i><b>9.2</b> Making your own objects</a><ul>
<li class="chapter" data-level="9.2.1" data-path="robjloops.html"><a href="robjloops.html#seeing-r-through-objects"><i class="fa fa-check"></i><b>9.2.1</b> Seeing R through objects</a></li>
<li class="chapter" data-level="9.2.2" data-path="robjloops.html"><a href="robjloops.html#parsing-an-object-by-strs"><i class="fa fa-check"></i><b>9.2.2</b> Parsing an object by <code>str()s</code></a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="robjloops.html"><a href="robjloops.html#types-of-variables"><i class="fa fa-check"></i><b>9.3</b> Types of variables</a><ul>
<li class="chapter" data-level="9.3.1" data-path="robjloops.html"><a href="robjloops.html#scalars"><i class="fa fa-check"></i><b>9.3.1</b> scalars</a></li>
<li class="chapter" data-level="9.3.2" data-path="robjloops.html"><a href="robjloops.html#numeric-vectors"><i class="fa fa-check"></i><b>9.3.2</b> numeric vectors</a></li>
<li class="chapter" data-level="9.3.3" data-path="robjloops.html"><a href="robjloops.html#characters-aka-strings"><i class="fa fa-check"></i><b>9.3.3</b> characters (aka strings)</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="robjloops.html"><a href="robjloops.html#what-is-a-function"><i class="fa fa-check"></i><b>9.4</b> What is a function?</a><ul>
<li class="chapter" data-level="9.4.1" data-path="robjloops.html"><a href="robjloops.html#write-your-own-function"><i class="fa fa-check"></i><b>9.4.1</b> Write your own function</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rmatrices.html"><a href="rmatrices.html#checkpoint"><i class="fa fa-check"></i>Checkpoint</a><ul>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section"><i class="fa fa-check"></i>1</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-1"><i class="fa fa-check"></i>2</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-2"><i class="fa fa-check"></i>3</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="robjloops.html"><a href="robjloops.html#what-is-a-package"><i class="fa fa-check"></i><b>9.5</b> What is a package?</a></li>
<li class="chapter" data-level="9.6" data-path="robjloops.html"><a href="robjloops.html#conditionals"><i class="fa fa-check"></i><b>9.6</b> Conditionals</a></li>
<li class="chapter" data-level="9.7" data-path="robjloops.html"><a href="robjloops.html#for-loops"><i class="fa fa-check"></i><b>9.7</b> For-loops</a></li>
<li class="chapter" data-level="9.8" data-path="robjloops.html"><a href="robjloops.html#nested-loops"><i class="fa fa-check"></i><b>9.8</b> Nested Loops</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="robjloops.html"><a href="robjloops.html#exercise-1-write-your-own-function"><i class="fa fa-check"></i>Exercise 1: Write your own function</a></li>
<li class="chapter" data-level="" data-path="robjloops.html"><a href="robjloops.html#exercise-2-using-loops"><i class="fa fa-check"></i>Exercise 2: Using Loops</a></li>
<li class="chapter" data-level="" data-path="robjloops.html"><a href="robjloops.html#exercise-3-storing-information-derived-within-loops-in-a-global-dataframe"><i class="fa fa-check"></i>Exercise 3: Storing information derived within loops in a global dataframe</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>10</b> Visualization</a><ul>
<li class="chapter" data-level="" data-path="dataviz.html"><a href="dataviz.html#motivation-the-law-of-the-census"><i class="fa fa-check"></i>Motivation: The Law of the Census</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#where-are-we-where-are-we-headed"><i class="fa fa-check"></i>Where are we? Where are we headed?</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#check-your-understanding"><i class="fa fa-check"></i>Check your understanding</a></li>
<li class="chapter" data-level="10.1" data-path="dataimport.html"><a href="dataimport.html#read-data"><i class="fa fa-check"></i><b>10.1</b> Read data</a></li>
<li class="chapter" data-level="10.2" data-path="dataviz.html"><a href="dataviz.html#counting"><i class="fa fa-check"></i><b>10.2</b> Counting</a></li>
<li class="chapter" data-level="10.3" data-path="dataviz.html"><a href="dataviz.html#tabulating"><i class="fa fa-check"></i><b>10.3</b> Tabulating</a></li>
<li class="chapter" data-level="10.4" data-path="dataviz.html"><a href="dataviz.html#base-r-graphics-and-ggplot"><i class="fa fa-check"></i><b>10.4</b> base R graphics and ggplot</a><ul>
<li class="chapter" data-level="10.4.1" data-path="dataviz.html"><a href="dataviz.html#base-r"><i class="fa fa-check"></i><b>10.4.1</b> base R</a></li>
<li class="chapter" data-level="10.4.2" data-path="dataviz.html"><a href="dataviz.html#ggplot"><i class="fa fa-check"></i><b>10.4.2</b> ggplot</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="dataviz.html"><a href="dataviz.html#improving-your-graphics"><i class="fa fa-check"></i><b>10.5</b> Improving your graphics</a></li>
<li class="chapter" data-level="10.6" data-path="dataviz.html"><a href="dataviz.html#cross-tabs"><i class="fa fa-check"></i><b>10.6</b> Cross-tabs</a></li>
<li class="chapter" data-level="10.7" data-path="dataviz.html"><a href="dataviz.html#composition-plots"><i class="fa fa-check"></i><b>10.7</b> Composition Plots</a></li>
<li class="chapter" data-level="10.8" data-path="dataviz.html"><a href="dataviz.html#line-graphs"><i class="fa fa-check"></i><b>10.8</b> Line graphs</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="dataviz.html"><a href="dataviz.html#rural-states"><i class="fa fa-check"></i>1: Rural states</a></li>
<li class="chapter" data-level="" data-path="dataviz.html"><a href="dataviz.html#the-swing-justice"><i class="fa fa-check"></i>2: The swing justice</a></li>
<li class="chapter" data-level="" data-path="dataviz.html"><a href="dataviz.html#dont-sort-by-the-alphabet"><i class="fa fa-check"></i>3: Don’t sort by the alphabet</a></li>
<li class="chapter" data-level="" data-path="dataviz.html"><a href="dataviz.html#what-to-show-and-how-to-show-it"><i class="fa fa-check"></i>4 What to show and how to show it</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dempeace.html"><a href="dempeace.html"><i class="fa fa-check"></i><b>11</b> Joins and Merges, Wide and Long</a><ul>
<li class="chapter" data-level="" data-path="rmatrices.html"><a href="rmatrices.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#where-are-we-where-are-we-headed"><i class="fa fa-check"></i>Where are we? Where are we headed?</a></li>
<li class="chapter" data-level="11.1" data-path="dempeace.html"><a href="dempeace.html#setting-up"><i class="fa fa-check"></i><b>11.1</b> Setting up</a></li>
<li class="chapter" data-level="11.2" data-path="dempeace.html"><a href="dempeace.html#create-a-project-directory"><i class="fa fa-check"></i><b>11.2</b> Create a project directory</a></li>
<li class="chapter" data-level="11.3" data-path="dempeace.html"><a href="dempeace.html#data-sources"><i class="fa fa-check"></i><b>11.3</b> Data Sources</a></li>
<li class="chapter" data-level="11.4" data-path="dempeace.html"><a href="dempeace.html#example-with-2-datasets"><i class="fa fa-check"></i><b>11.4</b> Example with 2 Datasets</a></li>
<li class="chapter" data-level="11.5" data-path="dempeace.html"><a href="dempeace.html#loops"><i class="fa fa-check"></i><b>11.5</b> Loops</a></li>
<li class="chapter" data-level="11.6" data-path="dempeace.html"><a href="dempeace.html#merging"><i class="fa fa-check"></i><b>11.6</b> Merging</a></li>
<li class="chapter" data-level="11.7" data-path="dempeace.html"><a href="dempeace.html#main-project"><i class="fa fa-check"></i><b>11.7</b> Main Project</a><ul>
<li class="chapter" data-level="" data-path="dempeace.html"><a href="dempeace.html#task-1-data-input-and-standardization"><i class="fa fa-check"></i>Task 1: Data Input and Standardization</a></li>
<li class="chapter" data-level="" data-path="dempeace.html"><a href="dempeace.html#task-2-data-merging"><i class="fa fa-check"></i>Task 2: Data Merging</a></li>
<li class="chapter" data-level="" data-path="dempeace.html"><a href="dempeace.html#task-3-tabulations-and-visualization"><i class="fa fa-check"></i>Task 3: Tabulations and Visualization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>12</b> Simulation</a><ul>
<li class="chapter" data-level="" data-path="simulation.html"><a href="simulation.html#motivation-simulation-as-an-analytical-tool"><i class="fa fa-check"></i>Motivation: Simulation as an Analytical Tool</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#where-are-we-where-are-we-headed"><i class="fa fa-check"></i>Where are we? Where are we headed?</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#check-your-understanding"><i class="fa fa-check"></i>Check your Understanding</a></li>
<li class="chapter" data-level="12.1" data-path="simulation.html"><a href="simulation.html#pick-a-sample-any-sample"><i class="fa fa-check"></i><b>12.1</b> Pick a sample, any sample</a></li>
<li class="chapter" data-level="12.2" data-path="simulation.html"><a href="simulation.html#the-sample-function"><i class="fa fa-check"></i><b>12.2</b> The <code>sample()</code> function</a><ul>
<li class="chapter" data-level="12.2.1" data-path="simulation.html"><a href="simulation.html#sampling-rows-from-a-dataframe"><i class="fa fa-check"></i><b>12.2.1</b> Sampling rows from a dataframe</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="simulation.html"><a href="simulation.html#random-numbers-from-specific-distributions"><i class="fa fa-check"></i><b>12.3</b> Random numbers from specific distributions</a><ul>
<li><a href="simulation.html#rbinom"><code>rbinom()</code></a></li>
<li><a href="simulation.html#runif"><code>runif()</code></a></li>
<li><a href="simulation.html#rnorm"><code>rnorm()</code></a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="simulation.html"><a href="simulation.html#r-p-and-d"><i class="fa fa-check"></i><b>12.4</b> r, p, and d</a></li>
<li class="chapter" data-level="12.5" data-path="simulation.html"><a href="simulation.html#set.seed"><i class="fa fa-check"></i><b>12.5</b> <code>set.seed()</code></a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="simulation.html"><a href="simulation.html#census-sampling"><i class="fa fa-check"></i>Census Sampling</a></li>
<li class="chapter" data-level="" data-path="simulation.html"><a href="simulation.html#conditional-proportions"><i class="fa fa-check"></i>Conditional Proportions</a></li>
<li class="chapter" data-level="" data-path="simulation.html"><a href="simulation.html#the-birthday-problem"><i class="fa fa-check"></i>The Birthday problem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html"><i class="fa fa-check"></i><b>13</b> LaTeX and markdown</a><ul>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#where-are-we-where-are-we-headed"><i class="fa fa-check"></i>Where are we? Where are we headed?</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#check-your-understanding"><i class="fa fa-check"></i>Check your understanding</a></li>
<li class="chapter" data-level="13.1" data-path="rmatrices.html"><a href="rmatrices.html#motivation"><i class="fa fa-check"></i><b>13.1</b> Motivation</a></li>
<li class="chapter" data-level="13.2" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#markdown"><i class="fa fa-check"></i><b>13.2</b> Markdown</a><ul>
<li class="chapter" data-level="13.2.1" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#markdown-commands"><i class="fa fa-check"></i><b>13.2.1</b> markdown commands</a></li>
<li class="chapter" data-level="13.2.2" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#your-own-markdown"><i class="fa fa-check"></i><b>13.2.2</b> your own markdown</a></li>
<li class="chapter" data-level="13.2.3" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#a-note-on-plain-text-editors"><i class="fa fa-check"></i><b>13.2.3</b> A note on plain-text editors</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#latex"><i class="fa fa-check"></i><b>13.3</b> LaTeX</a><ul>
<li class="chapter" data-level="13.3.1" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#compile-online"><i class="fa fa-check"></i><b>13.3.1</b> compile online</a></li>
<li class="chapter" data-level="13.3.2" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#compile-your-first-latex-document-locally"><i class="fa fa-check"></i><b>13.3.2</b> compile your first LaTeX document locally</a></li>
<li class="chapter" data-level="13.3.3" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#main-latex-commands"><i class="fa fa-check"></i><b>13.3.3</b> main LaTeX commands</a></li>
<li class="chapter" data-level="" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#further-guides"><i class="fa fa-check"></i>Further Guides</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#bibtex"><i class="fa fa-check"></i><b>13.4</b> BibTeX</a><ul>
<li class="chapter" data-level="13.4.1" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#what-is-a-.bib-file"><i class="fa fa-check"></i><b>13.4.1</b> what is a <code>.bib</code> file?</a></li>
<li class="chapter" data-level="13.4.2" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#what-does-latex-do-with-.bib-files"><i class="fa fa-check"></i><b>13.4.2</b> what does LaTeX do with .bib files?</a></li>
<li class="chapter" data-level="13.4.3" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#stocking-up-on-your-.bib-files"><i class="fa fa-check"></i><b>13.4.3</b> stocking up on your .bib files</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#exercise"><i class="fa fa-check"></i>Exercise</a></li>
<li class="chapter" data-level="" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#concluding-the-prefresher"><i class="fa fa-check"></i>Concluding the Prefresher</a><ul>
<li class="chapter" data-level="" data-path="nonwysiwyg.html"><a href="nonwysiwyg.html#your-feedback-matters"><i class="fa fa-check"></i>Your Feedback Matters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="rtext.html"><a href="rtext.html"><i class="fa fa-check"></i><b>14</b> Text</a><ul>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#where-are-we-where-are-we-headed"><i class="fa fa-check"></i>Where are we? Where are we headed?</a></li>
<li class="chapter" data-level="14.1" data-path="rtext.html"><a href="rtext.html#review"><i class="fa fa-check"></i><b>14.1</b> Review</a></li>
<li class="chapter" data-level="14.2" data-path="rtext.html"><a href="rtext.html#goals-for-today"><i class="fa fa-check"></i><b>14.2</b> Goals for today</a></li>
<li class="chapter" data-level="14.3" data-path="rtext.html"><a href="rtext.html#reading-and-writing-text-in-r"><i class="fa fa-check"></i><b>14.3</b> Reading and writing text in R</a></li>
<li class="chapter" data-level="14.4" data-path="rtext.html"><a href="rtext.html#paste-and-sprintf"><i class="fa fa-check"></i><b>14.4</b> <code>paste()</code> and <code>sprintf()</code></a></li>
<li class="chapter" data-level="14.5" data-path="rtext.html"><a href="rtext.html#regular-expressions"><i class="fa fa-check"></i><b>14.5</b> Regular expressions</a><ul>
<li class="chapter" data-level="14.5.1" data-path="rtext.html"><a href="rtext.html#character-classes"><i class="fa fa-check"></i><b>14.5.1</b> Character classes</a></li>
<li class="chapter" data-level="14.5.2" data-path="rtext.html"><a href="rtext.html#special-characters."><i class="fa fa-check"></i><b>14.5.2</b> Special Characters.</a></li>
<li class="chapter" data-level="14.5.3" data-path="rtext.html"><a href="rtext.html#conditional-patterns"><i class="fa fa-check"></i><b>14.5.3</b> Conditional patterns</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="rtext.html"><a href="rtext.html#representing-text"><i class="fa fa-check"></i><b>14.6</b> Representing Text</a></li>
<li class="chapter" data-level="14.7" data-path="rtext.html"><a href="rtext.html#important-packages-for-parsing-text"><i class="fa fa-check"></i><b>14.7</b> Important packages for parsing text</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#exercises"><i class="fa fa-check"></i>Exercises</a><ul>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section"><i class="fa fa-check"></i>1</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-1"><i class="fa fa-check"></i>2</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-2"><i class="fa fa-check"></i>3</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-3"><i class="fa fa-check"></i>4</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-4"><i class="fa fa-check"></i>5</a></li>
<li class="chapter" data-level="" data-path="dataimport.html"><a href="dataimport.html#section-5"><i class="fa fa-check"></i>6</a></li>
<li class="chapter" data-level="" data-path="rmatrices.html"><a href="rmatrices.html#section-6"><i class="fa fa-check"></i>7</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Solutions</b></span></li>
<li class="chapter" data-level="" data-path="solutions-to-warmup-questions.html"><a href="solutions-to-warmup-questions.html"><i class="fa fa-check"></i>Solutions to Warmup Questions</a><ul>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#linear-algebra"><i class="fa fa-check"></i>Linear Algebra</a><ul>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#vectors"><i class="fa fa-check"></i>Vectors</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#matrices"><i class="fa fa-check"></i>Matrices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#operations"><i class="fa fa-check"></i>Operations</a><ul>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#summation"><i class="fa fa-check"></i>Summation</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#products"><i class="fa fa-check"></i>Products</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#logs-and-exponents"><i class="fa fa-check"></i>Logs and exponents</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#limits"><i class="fa fa-check"></i>Limits</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#calculus"><i class="fa fa-check"></i>Calculus</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#optimization"><i class="fa fa-check"></i>Optimization</a></li>
<li class="chapter" data-level="" data-path="r-and-all-that.html"><a href="r-and-all-that.html#probability"><i class="fa fa-check"></i>Probability</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="suggested-programming-solutions.html"><a href="suggested-programming-solutions.html"><i class="fa fa-check"></i>Suggested Programming Solutions</a><ul>
<li class="chapter" data-level="14.8" data-path="suggested-programming-solutions.html"><a href="suggested-programming-solutions.html#chapter-refdataviz-visualization"><i class="fa fa-check"></i><b>14.8</b> Chapter @ref(dataviz): Visualization</a><ul>
<li class="chapter" data-level="" data-path="suggested-programming-solutions.html"><a href="suggested-programming-solutions.html#state-proportions"><i class="fa fa-check"></i>1 State Proportions</a></li>
<li class="chapter" data-level="" data-path="suggested-programming-solutions.html"><a href="suggested-programming-solutions.html#swing-justice"><i class="fa fa-check"></i>2 Swing Justice</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="suggested-programming-solutions.html"><a href="suggested-programming-solutions.html#chapter-refrobjloops-objects-and-loops"><i class="fa fa-check"></i><b>14.9</b> Chapter @ref(robjloops): Objects and Loops</a><ul>
<li class="chapter" data-level="" data-path="suggested-programming-solutions.html"><a href="suggested-programming-solutions.html#checkpoint-3"><i class="fa fa-check"></i>Checkpoint #3</a></li>
<li class="chapter" data-level="" data-path="suggested-programming-solutions.html"><a href="suggested-programming-solutions.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="suggested-programming-solutions.html"><a href="suggested-programming-solutions.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="suggested-programming-solutions.html"><a href="suggested-programming-solutions.html#chapter-refdempeace-demoratic-peace-project"><i class="fa fa-check"></i><b>14.10</b> Chapter @ref(dempeace): Demoratic Peace Project</a><ul>
<li class="chapter" data-level="" data-path="dempeace.html"><a href="dempeace.html#task-1-data-input-and-standardization"><i class="fa fa-check"></i>Task 1: Data Input and Standardization</a></li>
<li class="chapter" data-level="" data-path="dempeace.html"><a href="dempeace.html#task-2-data-merging"><i class="fa fa-check"></i>Task 2: Data Merging</a></li>
<li class="chapter" data-level="" data-path="dempeace.html"><a href="dempeace.html#task-3-tabulations-and-visualization"><i class="fa fa-check"></i>Task 3: Tabulations and Visualization</a></li>
</ul></li>
<li class="chapter" data-level="14.11" data-path="suggested-programming-solutions.html"><a href="suggested-programming-solutions.html#chapter-refsimulation-simulation"><i class="fa fa-check"></i><b>14.11</b> Chapter @ref(simulation): Simulation</a><ul>
<li class="chapter" data-level="14.11.1" data-path="simulation.html"><a href="simulation.html#census-sampling"><i class="fa fa-check"></i><b>14.11.1</b> Census Sampling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="markov-chain-monte-carlo-methods.html"><a href="markov-chain-monte-carlo-methods.html"><i class="fa fa-check"></i><b>15</b> Markov Chain Monte Carlo Methods</a><ul>
<li class="chapter" data-level="15.1" data-path="markov-chain-monte-carlo-methods.html"><a href="markov-chain-monte-carlo-methods.html#introduction"><i class="fa fa-check"></i><b>15.1</b> Introduction</a><ul>
<li class="chapter" data-level="15.1.1" data-path="markov-chain-monte-carlo-methods.html"><a href="markov-chain-monte-carlo-methods.html#law-of-total-probability"><i class="fa fa-check"></i><b>15.1.1</b> Law of Total Probability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="primer-math.html"><a href="primer-math.html"><i class="fa fa-check"></i><b>16</b> Primer Math</a><ul>
<li class="chapter" data-level="16.1" data-path="primer-math.html"><a href="primer-math.html#a-note-on-computer-arithmetric"><i class="fa fa-check"></i><b>16.1</b> A Note on Computer Arithmetric</a></li>
<li class="chapter" data-level="16.2" data-path="primer-math.html"><a href="primer-math.html#chapter-1.-matrices-linear-algebra-and-vector-geometry-the-basics"><i class="fa fa-check"></i><b>16.2</b> Chapter 1. Matrices, Linear Algebra, and Vector Geometry: The Basics</a></li>
<li class="chapter" data-level="16.3" data-path="primer-math.html"><a href="primer-math.html#basic-matrix-arithmetic"><i class="fa fa-check"></i><b>16.3</b> Basic Matrix Arithmetic</a></li>
<li class="chapter" data-level="16.4" data-path="primer-math.html"><a href="primer-math.html#matrix-inversion"><i class="fa fa-check"></i><b>16.4</b> Matrix Inversion</a></li>
<li class="chapter" data-level="16.5" data-path="primer-math.html"><a href="primer-math.html#geometric-vectors"><i class="fa fa-check"></i><b>16.5</b> Geometric Vectors</a></li>
<li class="chapter" data-level="16.6" data-path="primer-math.html"><a href="primer-math.html#solution-of-systems-of-linear-simultaneous-equations"><i class="fa fa-check"></i><b>16.6</b> Solution of Systems of Linear Simultaneous Equations</a></li>
<li class="chapter" data-level="16.7" data-path="primer-math.html"><a href="primer-math.html#generalized-inverses"><i class="fa fa-check"></i><b>16.7</b> Generalized Inverses</a></li>
<li class="chapter" data-level="16.8" data-path="primer-math.html"><a href="primer-math.html#chapter-2-matrix-decompositions-and-quadratic-forms"><i class="fa fa-check"></i><b>16.8</b> Chapter 2: Matrix Decompositions and Quadratic Forms</a></li>
<li class="chapter" data-level="16.9" data-path="primer-math.html"><a href="primer-math.html#eigenvalues-and-eigenvectors"><i class="fa fa-check"></i><b>16.9</b> Eigenvalues and Eigenvectors</a></li>
<li class="chapter" data-level="16.10" data-path="primer-math.html"><a href="primer-math.html#the-cholesky-decomposition"><i class="fa fa-check"></i><b>16.10</b> The Cholesky Decomposition</a></li>
<li class="chapter" data-level="16.11" data-path="primer-math.html"><a href="primer-math.html#the-qr-decomposition"><i class="fa fa-check"></i><b>16.11</b> The QR Decomposition</a></li>
<li class="chapter" data-level="16.12" data-path="primer-math.html"><a href="primer-math.html#chapter-3.-an-introduction-to-calculus"><i class="fa fa-check"></i><b>16.12</b> Chapter 3. An Introduction to Calculus</a></li>
<li class="chapter" data-level="16.13" data-path="primer-math.html"><a href="primer-math.html#maximization-and-minimization"><i class="fa fa-check"></i><b>16.13</b> Maximization and Minimization</a></li>
<li class="chapter" data-level="16.14" data-path="derivatives.html"><a href="derivatives.html#partial-derivatives"><i class="fa fa-check"></i><b>16.14</b> Partial Derivatives</a></li>
<li class="chapter" data-level="16.15" data-path="primer-math.html"><a href="primer-math.html#lagrange-multipliers-for-constrained-optimization"><i class="fa fa-check"></i><b>16.15</b> Lagrange Multipliers for Constrained Optimization</a></li>
<li class="chapter" data-level="16.16" data-path="primer-math.html"><a href="primer-math.html#numerical-optimization"><i class="fa fa-check"></i><b>16.16</b> Numerical Optimization</a></li>
<li class="chapter" data-level="16.17" data-path="primer-math.html"><a href="primer-math.html#integration"><i class="fa fa-check"></i><b>16.17</b> Integration</a></li>
<li class="chapter" data-level="16.18" data-path="primer-math.html"><a href="primer-math.html#chapter-5.-common-probability-distributions"><i class="fa fa-check"></i><b>16.18</b> Chapter 5. Common Probability Distributions</a></li>
<li class="chapter" data-level="16.19" data-path="primer-math.html"><a href="primer-math.html#chapter-6.-an-introduction-to-statistical-theory"><i class="fa fa-check"></i><b>16.19</b> Chapter 6. An Introduction to Statistical Theory</a></li>
<li class="chapter" data-level="16.20" data-path="primer-math.html"><a href="primer-math.html#central-limit-theorem"><i class="fa fa-check"></i><b>16.20</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="16.21" data-path="primer-math.html"><a href="primer-math.html#robust-estimation"><i class="fa fa-check"></i><b>16.21</b> Robust Estimation</a></li>
<li class="chapter" data-level="16.22" data-path="primer-math.html"><a href="primer-math.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>16.22</b> Maximum-Likelihood Estimation</a></li>
<li class="chapter" data-level="16.23" data-path="primer-math.html"><a href="primer-math.html#the-delta-method"><i class="fa fa-check"></i><b>16.23</b> The Delta Method</a></li>
<li class="chapter" data-level="16.24" data-path="primer-math.html"><a href="primer-math.html#bayesian-inference"><i class="fa fa-check"></i><b>16.24</b> Bayesian Inference</a></li>
<li class="chapter" data-level="16.25" data-path="primer-math.html"><a href="primer-math.html#the-metropolis-algorithm"><i class="fa fa-check"></i><b>16.25</b> The Metropolis Algorithm</a></li>
<li class="chapter" data-level="16.26" data-path="primer-math.html"><a href="primer-math.html#chapter-7.-putting-the-math-to-work-linear-least-squares-regression"><i class="fa fa-check"></i><b>16.26</b> Chapter 7. Putting the Math to Work: Linear Least-Squares Regression</a></li>
<li class="chapter" data-level="16.27" data-path="primer-math.html"><a href="primer-math.html#computing-the-least-squares-regression-coefficients"><i class="fa fa-check"></i><b>16.27</b> Computing the Least-Squares Regression Coefficients</a></li>
<li class="chapter" data-level="16.28" data-path="primer-math.html"><a href="primer-math.html#inference-for-linear-least-squares-regression"><i class="fa fa-check"></i><b>16.28</b> Inference for Linear Least-Squares Regression</a></li>
<li class="chapter" data-level="16.29" data-path="primer-math.html"><a href="primer-math.html#the-elliptical-geometry-of-least-squares-regression"><i class="fa fa-check"></i><b>16.29</b> The Elliptical Geometry of Least-Squares Regression</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="confidence-ellipse.html"><a href="confidence-ellipse.html"><i class="fa fa-check"></i><b>17</b> 95% confidence ellipse:</a></li>
<li class="chapter" data-level="18" data-path="confidence-interval-generating-ellipse.html"><a href="confidence-interval-generating-ellipse.html"><i class="fa fa-check"></i><b>18</b> 95% confidence-interval generating ellipse</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mathemathics and Statistics Bootcamp for Econonomics and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="primer-math" class="section level1">
<h1><span class="header-section-number">Chapter 16</span> Primer Math</h1>
<p>This document shows how to work out the numerical examples (and some of the symbolic examples) in <em>A Mathematical Primer for Social Statistics, Second Edition</em> <span class="citation">[@Fox2020]</span> in the R statistical computing environment <span class="citation">[@RCore2020]</span>.</p>
<div id="a-note-on-computer-arithmetric" class="section level2">
<h2><span class="header-section-number">16.1</span> A Note on Computer Arithmetric</h2>
<p>Like most numerically oriented computer software, non-integer real numbers in R are represented as double-precision floating point numbers to approximately 16 decimal-digit accuracy. Computations can accumulate rounding errors that produce substantially less accuracy in a final result, and performing a computation in theoretically equivalent but non-identical manners can yield slightly different results—or, in pathological cases, dramatically different and even incorrect results. As a consequence, it is generally a bad idea to test that a number resulting from a computation is precisely equal to a particular value (like zero) or to test that two theoretically equal numbers resulting from different computations are exactly equal.</p>
<p>Consider the following example: Basic trigonometric functions are reviewed in Section 3.1.5 of the text. As is apparent in the following graph (similar to Figure 3.7 in the text), <span class="math inline">\(\cos(x) = \sin(x + 90)\)</span>, where the angle <span class="math inline">\(x\)</span> is measured in degrees:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="primer-math.html#cb1-1"></a><span class="kw">curve</span>(sin, <span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>pi, <span class="dt">ann=</span><span class="ot">FALSE</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1-2"><a href="primer-math.html#cb1-2"></a><span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">at=</span><span class="kw">c</span>(<span class="dv">0</span>, pi<span class="op">/</span><span class="dv">2</span>, pi, <span class="dv">3</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>pi),</span>
<span id="cb1-3"><a href="primer-math.html#cb1-3"></a>    <span class="dt">labels=</span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="dv">0</span><span class="op">*</span>degree), <span class="kw">expression</span>(<span class="dv">90</span><span class="op">*</span>degree), </span>
<span id="cb1-4"><a href="primer-math.html#cb1-4"></a>             <span class="kw">expression</span>(<span class="dv">180</span><span class="op">*</span>degree), <span class="kw">expression</span>(<span class="dv">270</span><span class="op">*</span>degree), </span>
<span id="cb1-5"><a href="primer-math.html#cb1-5"></a>             <span class="kw">expression</span>(<span class="dv">360</span><span class="op">*</span>degree)))</span>
<span id="cb1-6"><a href="primer-math.html#cb1-6"></a><span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">pos=</span><span class="dv">0</span>)</span>
<span id="cb1-7"><a href="primer-math.html#cb1-7"></a><span class="kw">curve</span>(cos, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">lty=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb1-8"><a href="primer-math.html#cb1-8"></a><span class="kw">legend</span>(pi, <span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;sine&quot;</span>, <span class="st">&quot;cosine&quot;</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>The trigonometric functions in R measure angles in radians (as is reflected in the R code for the graph), and remembering that <span class="math inline">\(90^\circ = \pi/2\)</span> radians, in radian measure <span class="math inline">\(\cos(x) = \sin(x + \pi/2)\)</span>. Let’s see what happens when we translate this equation into R code for several angles between zero and <span class="math inline">\(\pi\)</span> radian:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="primer-math.html#cb2-1"></a>(angles &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, pi, <span class="dt">length=</span><span class="dv">6</span>))</span></code></pre></div>
<pre><code>## [1] 0.0000000 0.6283185 1.2566371 1.8849556 2.5132741 3.1415927</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="primer-math.html#cb4-1"></a>(c &lt;-<span class="st"> </span><span class="kw">cos</span>(angles))</span></code></pre></div>
<pre><code>## [1]  1.000000  0.809017  0.309017 -0.309017 -0.809017 -1.000000</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="primer-math.html#cb6-1"></a>(s &lt;-<span class="st"> </span><span class="kw">sin</span>(angles <span class="op">+</span><span class="st"> </span>pi<span class="op">/</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1]  1.000000  0.809017  0.309017 -0.309017 -0.809017 -1.000000</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="primer-math.html#cb8-1"></a><span class="kw">all</span>(c <span class="op">==</span><span class="st"> </span>s)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="primer-math.html#cb10-1"></a>c <span class="op">-</span><span class="st"> </span>s</span></code></pre></div>
<pre><code>## [1]  0.000000e+00  0.000000e+00 -5.551115e-17 -5.551115e-17  0.000000e+00
## [6]  0.000000e+00</code></pre>
<p>To the precision that numbers are printed by default in R, <code>cos(angles)</code> and <code>sin(angles + pi/2)</code> appear to produce the same results, as we might naively expect. But if we test for equality or subtract one result from the other, we see that they are not identical: Two of the pairs of numbers differ by a very small amount, about <span class="math inline">\(6 \times 10^{-17}\)</span>. Recall that real numbers in R are represented to about 16 decimal places of precision.</p>
</div>
<div id="chapter-1.-matrices-linear-algebra-and-vector-geometry-the-basics" class="section level2">
<h2><span class="header-section-number">16.2</span> Chapter 1. Matrices, Linear Algebra, and Vector Geometry: The Basics</h2>
</div>
<div id="basic-matrix-arithmetic" class="section level2">
<h2><span class="header-section-number">16.3</span> Basic Matrix Arithmetic</h2>
<p>Matrix addition, subtraction, negation, and transposition:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="primer-math.html#cb12-1"></a>(A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="primer-math.html#cb14-1"></a>(B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">-4</span>), <span class="dt">nrow=</span><span class="dv">2</span>, <span class="dt">ncol=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   -5    1    2
## [2,]    3    0   -4</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="primer-math.html#cb16-1"></a>(C &lt;-<span class="st"> </span>A <span class="op">+</span><span class="st"> </span>B) <span class="co"># addition</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   -4    3    5
## [2,]    7    5    2</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="primer-math.html#cb18-1"></a>(D &lt;-<span class="st"> </span>A <span class="op">-</span><span class="st"> </span>B) <span class="co"># subtraction</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    6    1    1
## [2,]    1    5   10</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="primer-math.html#cb20-1"></a>(E &lt;-<span class="st"> </span><span class="op">-</span>B) <span class="co"># negation</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    5   -1   -2
## [2,]   -3    0    4</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="primer-math.html#cb22-1"></a><span class="kw">t</span>(A) <span class="co"># transpose</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6</code></pre>
<p>Product of a matrix and a scalar:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="primer-math.html#cb24-1"></a>(F &lt;-<span class="st"> </span><span class="dv">3</span><span class="op">*</span>B)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  -15    3    6
## [2,]    9    0  -12</code></pre>
<p>Inner product of two vectors:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="primer-math.html#cb26-1"></a><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">9</span>)</span></code></pre></div>
<pre><code>##      [,1]
## [1,]   25</code></pre>
<p>Note the following:</p>
<ul>
<li>There is usually no need in R to define a vector as a row vector (i.e, a one-row matrix) or a column vector (a one-column matrix), although one may do so.</li>
<li>The inner-product operator <code>%*%</code> produces a <span class="math inline">\((1 \times 1)\)</span> matrix as a result rather than a true scalar. In fact, there are no true scalars in R–the simplest data structure is a one-element vector. As shown below, the inner-product operator is also used for matrix multiplication.</li>
</ul>
<p>Examples of matrix products:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="primer-math.html#cb28-1"></a>A <span class="co"># recall</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="primer-math.html#cb30-1"></a>(I_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">3</span>)) <span class="co"># order-3 identity matrix</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="primer-math.html#cb32-1"></a>A <span class="op">%*%</span><span class="st"> </span>I_<span class="dv">3</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="primer-math.html#cb34-1"></a>(W &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    2
## [2,]    3    4</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="primer-math.html#cb36-1"></a>(X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    0    3
## [2,]    2    1</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="primer-math.html#cb38-1"></a>W <span class="op">%*%</span><span class="st"> </span>X  <span class="co"># W and X don&#39;t commute</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    4    5
## [2,]    8   13</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="primer-math.html#cb40-1"></a>X <span class="op">%*%</span><span class="st"> </span>W</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    9   12
## [2,]    5    8</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="primer-math.html#cb42-1"></a>(Y &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)))</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    2    0
## [2,]    0    3</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="primer-math.html#cb44-1"></a>(Z &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)))</span></code></pre></div>
<pre><code>##      [,1]      [,2]
## [1,]  0.5 0.0000000
## [2,]  0.0 0.3333333</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="primer-math.html#cb46-1"></a>Y <span class="op">%*%</span><span class="st"> </span>Z  <span class="co"># Y and Z commute</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    0    1</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="primer-math.html#cb48-1"></a>Z <span class="op">%*%</span><span class="st"> </span>Y</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    0    1</code></pre>
</div>
<div id="matrix-inversion" class="section level2">
<h2><span class="header-section-number">16.4</span> Matrix Inversion</h2>
<p>The matrix inverse:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="primer-math.html#cb50-1"></a>(A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    2    5
## [2,]    1    3</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="primer-math.html#cb52-1"></a>(B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">-5</span>, <span class="dv">-1</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)) <span class="co"># B = A^-1</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    3   -5
## [2,]   -1    2</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="primer-math.html#cb54-1"></a>A <span class="op">%*%</span><span class="st"> </span>B <span class="co"># check = I</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    0    1</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="primer-math.html#cb56-1"></a>B <span class="op">%*%</span><span class="st"> </span>A</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    0
## [2,]    0    1</code></pre>
<p>Finding a matrix inverse by Gaussian elimination:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="primer-math.html#cb58-1"></a><span class="kw">library</span>(<span class="st">&quot;matlib&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: package &#39;matlib&#39; was built under R version 4.0.3</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="primer-math.html#cb60-1"></a>(A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">-2</span>,  <span class="dv">0</span>,</span>
<span id="cb60-2"><a href="primer-math.html#cb60-2"></a>               <span class="dv">1</span>, <span class="dv">-1</span>,  <span class="dv">1</span>,</span>
<span id="cb60-3"><a href="primer-math.html#cb60-3"></a>               <span class="dv">4</span>,  <span class="dv">4</span>, <span class="dv">-4</span>),</span>
<span id="cb60-4"><a href="primer-math.html#cb60-4"></a>             <span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    2   -2    0
## [2,]    1   -1    1
## [3,]    4    4   -4</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="primer-math.html#cb62-1"></a>B &lt;-<span class="st"> </span><span class="kw">gaussianElimination</span>(A, <span class="kw">diag</span>(<span class="dv">3</span>), <span class="dt">verbose=</span><span class="ot">TRUE</span>, <span class="dt">fractions=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Initial matrix:
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]  2   -2    0    1    0    0  
## [2,]  1   -1    1    0    1    0  
## [3,]  4    4   -4    0    0    1  
## 
## row: 1 
## 
##  exchange rows 1 and 3 
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]  4    4   -4    0    0    1  
## [2,]  1   -1    1    0    1    0  
## [3,]  2   -2    0    1    0    0  
## 
##  multiply row 1 by 1/4 
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]   1    1   -1    0    0  1/4 
## [2,]   1   -1    1    0    1    0 
## [3,]   2   -2    0    1    0    0 
## 
##  subtract row 1 from row 2 
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    1   -1    0    0  1/4
## [2,]    0   -2    2    0    1 -1/4
## [3,]    2   -2    0    1    0    0
## 
##  multiply row 1 by 2 and subtract from row 3 
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    1   -1    0    0  1/4
## [2,]    0   -2    2    0    1 -1/4
## [3,]    0   -4    2    1    0 -1/2
## 
## row: 2 
## 
##  exchange rows 2 and 3 
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    1   -1    0    0  1/4
## [2,]    0   -4    2    1    0 -1/2
## [3,]    0   -2    2    0    1 -1/4
## 
##  multiply row 2 by -1/4 
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    1   -1    0    0  1/4
## [2,]    0    1 -1/2 -1/4    0  1/8
## [3,]    0   -2    2    0    1 -1/4
## 
##  subtract row 2 from row 1 
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    0 -1/2  1/4    0  1/8
## [2,]    0    1 -1/2 -1/4    0  1/8
## [3,]    0   -2    2    0    1 -1/4
## 
##  multiply row 2 by 2 and add to row 3 
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    0 -1/2  1/4    0  1/8
## [2,]    0    1 -1/2 -1/4    0  1/8
## [3,]    0    0    1 -1/2    1    0
## 
## row: 3 
## 
##  multiply row 3 by 1/2 and add to row 1 
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    0    0    0  1/2  1/8
## [2,]    0    1 -1/2 -1/4    0  1/8
## [3,]    0    0    1 -1/2    1    0
## 
##  multiply row 3 by 1/2 and add to row 2 
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    0    0    0  1/2  1/8
## [2,]    0    1    0 -1/2  1/2  1/8
## [3,]    0    0    1 -1/2    1    0</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="primer-math.html#cb64-1"></a>(B &lt;-<span class="st"> </span>B[, <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>]) <span class="co"># B should be A^-1</span></span></code></pre></div>
<pre><code>##      [,1] [,2]  [,3]
## [1,]  0.0  0.5 0.125
## [2,] -0.5  0.5 0.125
## [3,] -0.5  1.0 0.000</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="primer-math.html#cb66-1"></a>A <span class="op">%*%</span><span class="st"> </span>B <span class="co"># check = I</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="primer-math.html#cb68-1"></a>B <span class="op">%*%</span><span class="st"> </span>A</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
<p>Notes:</p>
<ul>
<li>The steps aren’t identical to those in the text because the <code>gaussianElimination()</code> function uses a <em>maximum-pivot strategy</em> to increase numerical accuracy: In processing each row, the function selects the largest absolute element in the pivot column at or below the current row and brings it into the pivot position, performing a row interchange if necessary. The object is still to reduce the original matrix (here, <code>A</code>) to the identity matrix.</li>
<li>The determinant is still the product of the pivots, <span class="math inline">\(4 \times -4 \times 1 = -16\)</span>, without changing the sign because there is an even number (2) of row interchanges.</li>
<li>The standard R <code>solve()</code> and <code>det()</code> functions compute the matrix inverse and determinant, respectively, more efficiently and potentially more accurately:</li>
</ul>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="primer-math.html#cb70-1"></a><span class="kw">solve</span>(A) <span class="co"># = A^-1</span></span></code></pre></div>
<pre><code>##      [,1] [,2]  [,3]
## [1,]  0.0  0.5 0.125
## [2,] -0.5  0.5 0.125
## [3,] -0.5  1.0 0.000</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="primer-math.html#cb72-1"></a><span class="kw">det</span>(A)</span></code></pre></div>
<pre><code>## [1] -16</code></pre>
</div>
<div id="geometric-vectors" class="section level2">
<h2><span class="header-section-number">16.5</span> Geometric Vectors</h2>
<p>Some vectors in 2D space:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="primer-math.html#cb74-1"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb74-2"><a href="primer-math.html#cb74-2"></a>               <span class="dv">1</span>, <span class="dv">2</span>,</span>
<span id="cb74-3"><a href="primer-math.html#cb74-3"></a>               <span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb74-4"><a href="primer-math.html#cb74-4"></a>              <span class="dv">-2</span>,<span class="op">-</span><span class="dv">2</span>), </span>
<span id="cb74-5"><a href="primer-math.html#cb74-5"></a>            <span class="dv">4</span>, <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb74-6"><a href="primer-math.html#cb74-6"></a><span class="kw">rownames</span>(X) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;(-1, 1)&#39;&quot;</span>, <span class="st">&quot;(1, 2)&#39;&quot;</span>, <span class="st">&quot;(3, -1)&#39;&quot;</span>, <span class="st">&quot;(-2, -2)&#39;&quot;</span>)</span>
<span id="cb74-7"><a href="primer-math.html#cb74-7"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="fl">3.5</span>), <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>), <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, </span>
<span id="cb74-8"><a href="primer-math.html#cb74-8"></a>     <span class="dt">xlab=</span><span class="kw">expression</span>(x[<span class="dv">1</span>]), <span class="dt">ylab=</span><span class="kw">expression</span>(x[<span class="dv">2</span>]), <span class="dt">asp=</span><span class="dv">1</span>)</span>
<span id="cb74-9"><a href="primer-math.html#cb74-9"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)</span>
<span id="cb74-10"><a href="primer-math.html#cb74-10"></a><span class="kw">vectors</span>(X, <span class="dt">cex=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-11-1.png" width="672" />
Setting <code>asp=1</code> (for “aspect ratio”) specifies that the scales of the two axes are the same units per cm, insuring that the lengths of the vectors are correct.</p>
<p>The <strong>matlib</strong> package can also draw vectors in 3D space (see <code>?vectors3d</code>), but it is more complicated to generate the 3D examples in the text.</p>
<p>The parallelogram rule of vector addition:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="primer-math.html#cb75-1"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb75-2"><a href="primer-math.html#cb75-2"></a>              <span class="dv">2</span>, <span class="dv">3</span>,</span>
<span id="cb75-3"><a href="primer-math.html#cb75-3"></a>              <span class="dv">3</span>, <span class="dv">1</span>), </span>
<span id="cb75-4"><a href="primer-math.html#cb75-4"></a>            <span class="dv">3</span>, <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb75-5"><a href="primer-math.html#cb75-5"></a><span class="kw">rownames</span>(X) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;(1, -2)&#39;&quot;</span>, <span class="st">&quot;(2, 3)&#39;&quot;</span>, <span class="st">&quot;(3, 1)&#39;&quot;</span>)</span>
<span id="cb75-6"><a href="primer-math.html#cb75-6"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, </span>
<span id="cb75-7"><a href="primer-math.html#cb75-7"></a>     <span class="dt">xlab=</span><span class="kw">expression</span>(x[<span class="dv">1</span>]), <span class="dt">ylab=</span><span class="kw">expression</span>(x[<span class="dv">2</span>]), <span class="dt">asp=</span><span class="dv">1</span>)</span>
<span id="cb75-8"><a href="primer-math.html#cb75-8"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)</span>
<span id="cb75-9"><a href="primer-math.html#cb75-9"></a><span class="kw">vectors</span>(X, <span class="dt">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb75-10"><a href="primer-math.html#cb75-10"></a><span class="kw">segments</span>(<span class="dt">x0=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">x1=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">y0=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">-2</span>), <span class="dt">y1=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>The product of a scalar and a vector:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="primer-math.html#cb76-1"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">3</span>,   <span class="dv">2</span>,</span>
<span id="cb76-2"><a href="primer-math.html#cb76-2"></a>              <span class="fl">4.5</span>, <span class="dv">3</span>,</span>
<span id="cb76-3"><a href="primer-math.html#cb76-3"></a>             <span class="dv">-3</span>,  <span class="dv">-2</span>), </span>
<span id="cb76-4"><a href="primer-math.html#cb76-4"></a>            <span class="dv">3</span>, <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb76-5"><a href="primer-math.html#cb76-5"></a><span class="kw">rownames</span>(X) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x = (3, 2)&#39;&quot;</span>, <span class="st">&quot;1.5x = (4.5, 3)&#39;&quot;</span>, <span class="st">&quot;-x = (-3, -1)&#39;&quot;</span>)</span>
<span id="cb76-6"><a href="primer-math.html#cb76-6"></a><span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">7</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="fl">4.5</span>), <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, </span>
<span id="cb76-7"><a href="primer-math.html#cb76-7"></a>     <span class="dt">xlab=</span><span class="kw">expression</span>(x[<span class="dv">1</span>]), <span class="dt">ylab=</span><span class="kw">expression</span>(x[<span class="dv">2</span>]), <span class="dt">asp=</span><span class="dv">1</span>)</span>
<span id="cb76-8"><a href="primer-math.html#cb76-8"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">h=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)</span>
<span id="cb76-9"><a href="primer-math.html#cb76-9"></a><span class="kw">vectors</span>(X, <span class="dt">cex=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="solution-of-systems-of-linear-simultaneous-equations" class="section level2">
<h2><span class="header-section-number">16.6</span> Solution of Systems of Linear Simultaneous Equations</h2>
<p>Putting a matrix in reduced row-echelon form (RREF) by Gaussian elimination:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="primer-math.html#cb77-1"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>,</span>
<span id="cb77-2"><a href="primer-math.html#cb77-2"></a>               <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb77-3"><a href="primer-math.html#cb77-3"></a>               <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb77-4"><a href="primer-math.html#cb77-4"></a>            <span class="dv">3</span>, <span class="dv">4</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb77-5"><a href="primer-math.html#cb77-5"></a><span class="kw">gaussianElimination</span>(A, <span class="dt">verbose=</span><span class="ot">TRUE</span>, <span class="dt">fractions=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Initial matrix:
##      [,1] [,2] [,3] [,4]
## [1,] -2    0   -1    2  
## [2,]  4    0    1    0  
## [3,]  6    0    1    2  
## 
## row: 1 
## 
##  exchange rows 1 and 3 
##      [,1] [,2] [,3] [,4]
## [1,]  6    0    1    2  
## [2,]  4    0    1    0  
## [3,] -2    0   -1    2  
## 
##  multiply row 1 by 1/6 
##      [,1] [,2] [,3] [,4]
## [1,]   1    0  1/6  1/3 
## [2,]   4    0    1    0 
## [3,]  -2    0   -1    2 
## 
##  multiply row 1 by 4 and subtract from row 2 
##      [,1] [,2] [,3] [,4]
## [1,]    1    0  1/6  1/3
## [2,]    0    0  1/3 -4/3
## [3,]   -2    0   -1    2
## 
##  multiply row 1 by 2 and add to row 3 
##      [,1] [,2] [,3] [,4]
## [1,]    1    0  1/6  1/3
## [2,]    0    0  1/3 -4/3
## [3,]    0    0 -2/3  8/3
## 
## row: 2 
## 
##  exchange rows 2 and 3 
##      [,1] [,2] [,3] [,4]
## [1,]    1    0  1/6  1/3
## [2,]    0    0 -2/3  8/3
## [3,]    0    0  1/3 -4/3
## 
##  multiply row 2 by -3/2 
##      [,1] [,2] [,3] [,4]
## [1,]    1    0  1/6  1/3
## [2,]    0    0    1   -4
## [3,]    0    0  1/3 -4/3
## 
##  multiply row 2 by 1/6 and subtract from row 1 
##      [,1] [,2] [,3] [,4]
## [1,]    1    0    0    1
## [2,]    0    0    1   -4
## [3,]    0    0  1/3 -4/3
## 
##  multiply row 2 by 1/3 and subtract from row 3 
##      [,1] [,2] [,3] [,4]
## [1,]  1    0    0    1  
## [2,]  0    0    1   -4  
## [3,]  0    0    0    0  
## 
## row: 3</code></pre>
<p>Note: Once again, the steps aren’t identical to those in the text because <code>gaussianElimination()</code> uses a maximum pivot strategy, but the resulting RREF of the matrix is the same.</p>
<p>Solving systems of linear simultaneous equations:</p>
<ul>
<li>An underidentified system of equations:
<span class="math display">\[
\begin{bmatrix*}[r]
-2 &amp; 0 &amp; -1 &amp; 2 \\
 4 &amp; 0 &amp;  1 &amp; 0 \\
 6 &amp; 0 &amp;  1 &amp; 2
\end{bmatrix*}
\begin{bmatrix}
 x_1 \\
 x_2 \\
 x_3 \\
 x_4
\end{bmatrix}
=
\begin{bmatrix}
 1 \\
 2 \\
 5
\end{bmatrix}
\]</span></li>
</ul>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="primer-math.html#cb79-1"></a><span class="kw">gaussianElimination</span>(A, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>), <span class="dt">verbose=</span><span class="ot">TRUE</span>, <span class="dt">fractions=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Initial matrix:
##      [,1] [,2] [,3] [,4] [,5]
## [1,] -2    0   -1    2    1  
## [2,]  4    0    1    0    2  
## [3,]  6    0    1    2    5  
## 
## row: 1 
## 
##  exchange rows 1 and 3 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]  6    0    1    2    5  
## [2,]  4    0    1    0    2  
## [3,] -2    0   -1    2    1  
## 
##  multiply row 1 by 1/6 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]   1    0  1/6  1/3  5/6 
## [2,]   4    0    1    0    2 
## [3,]  -2    0   -1    2    1 
## 
##  multiply row 1 by 4 and subtract from row 2 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0  1/6  1/3  5/6
## [2,]    0    0  1/3 -4/3 -4/3
## [3,]   -2    0   -1    2    1
## 
##  multiply row 1 by 2 and add to row 3 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0  1/6  1/3  5/6
## [2,]    0    0  1/3 -4/3 -4/3
## [3,]    0    0 -2/3  8/3  8/3
## 
## row: 2 
## 
##  exchange rows 2 and 3 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0  1/6  1/3  5/6
## [2,]    0    0 -2/3  8/3  8/3
## [3,]    0    0  1/3 -4/3 -4/3
## 
##  multiply row 2 by -3/2 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0  1/6  1/3  5/6
## [2,]    0    0    1   -4   -4
## [3,]    0    0  1/3 -4/3 -4/3
## 
##  multiply row 2 by 1/6 and subtract from row 1 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    1  3/2
## [2,]    0    0    1   -4   -4
## [3,]    0    0  1/3 -4/3 -4/3
## 
##  multiply row 2 by 1/3 and subtract from row 3 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]   1    0    0    1  3/2 
## [2,]   0    0    1   -4   -4 
## [3,]   0    0    0    0    0 
## 
## row: 3</code></pre>
<p>Once more, the steps are different from those in the text, but the result is the same, implying that <span class="math inline">\(x_1 = 3/2 - x_4\)</span> and <span class="math inline">\(x_3 = -4 +4x_4\)</span>.</p>
<ul>
<li>An overdetermined system:
<span class="math display">\[
\begin{bmatrix*}[r]
-2 &amp; 0 &amp; -1 &amp; 2 \\
 4 &amp; 0 &amp;  1 &amp; 0 \\
 6 &amp; 0 &amp;  1 &amp; 2
\end{bmatrix*}
\begin{bmatrix}
 x_1 \\
 x_2 \\
 x_3 \\
 x_4
\end{bmatrix}
=
\begin{bmatrix}
 1 \\
 2 \\
 1
\end{bmatrix}
\]</span></li>
</ul>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="primer-math.html#cb81-1"></a><span class="kw">gaussianElimination</span>(A, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">verbose=</span><span class="ot">TRUE</span>, <span class="dt">fractions=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Initial matrix:
##      [,1] [,2] [,3] [,4] [,5]
## [1,] -2    0   -1    2    1  
## [2,]  4    0    1    0    2  
## [3,]  6    0    1    2    1  
## 
## row: 1 
## 
##  exchange rows 1 and 3 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]  6    0    1    2    1  
## [2,]  4    0    1    0    2  
## [3,] -2    0   -1    2    1  
## 
##  multiply row 1 by 1/6 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]   1    0  1/6  1/3  1/6 
## [2,]   4    0    1    0    2 
## [3,]  -2    0   -1    2    1 
## 
##  multiply row 1 by 4 and subtract from row 2 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0  1/6  1/3  1/6
## [2,]    0    0  1/3 -4/3  4/3
## [3,]   -2    0   -1    2    1
## 
##  multiply row 1 by 2 and add to row 3 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0  1/6  1/3  1/6
## [2,]    0    0  1/3 -4/3  4/3
## [3,]    0    0 -2/3  8/3  4/3
## 
## row: 2 
## 
##  exchange rows 2 and 3 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0  1/6  1/3  1/6
## [2,]    0    0 -2/3  8/3  4/3
## [3,]    0    0  1/3 -4/3  4/3
## 
##  multiply row 2 by -3/2 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0  1/6  1/3  1/6
## [2,]    0    0    1   -4   -2
## [3,]    0    0  1/3 -4/3  4/3
## 
##  multiply row 2 by 1/6 and subtract from row 1 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    0    0    1  1/2
## [2,]    0    0    1   -4   -2
## [3,]    0    0  1/3 -4/3  4/3
## 
##  multiply row 2 by 1/3 and subtract from row 3 
##      [,1] [,2] [,3] [,4] [,5]
## [1,]   1    0    0    1  1/2 
## [2,]   0    0    1   -4   -2 
## [3,]   0    0    0    0    2 
## 
## row: 3</code></pre>
<p>The last row of the result reveals the contradiction, that is, <span class="math inline">\(0x_1 + 0x_2 + 0x_3 + 0x_4 = 2\)</span>.</p>
<p>The standard R <code>solve()</code> function may be used to solve systems of linear equations with equal numbers of equations and unknowns so long as the coefficient matrix is nonsingular.</p>
</div>
<div id="generalized-inverses" class="section level2">
<h2><span class="header-section-number">16.7</span> Generalized Inverses</h2>
<p>The <code>Ginv()</code> function in the <strong>matlib</strong> package computes generalized inverses using Gaussian elimination. For example, for a the rectangular matrix <code>A</code>:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="primer-math.html#cb83-1"></a>A <span class="co"># recall</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]   -2    0   -1    2
## [2,]    4    0    1    0
## [3,]    6    0    1    2</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="primer-math.html#cb85-1"></a>B &lt;-<span class="st"> </span><span class="kw">Ginv</span>(A, <span class="dt">verbose=</span><span class="ot">TRUE</span>, <span class="dt">fractions=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## Initial matrix:
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,] -2    0   -1    2    1    0    0  
## [2,]  4    0    1    0    0    1    0  
## [3,]  6    0    1    2    0    0    1  
## 
## row: 1 
## 
##  exchange rows 1 and 3 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]  6    0    1    2    0    0    1  
## [2,]  4    0    1    0    0    1    0  
## [3,] -2    0   -1    2    1    0    0  
## 
##  multiply row 1 by 1/6 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]   1    0  1/6  1/3    0    0  1/6 
## [2,]   4    0    1    0    0    1    0 
## [3,]  -2    0   -1    2    1    0    0 
## 
##  multiply row 1 by 4 and subtract from row 2 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    1    0  1/6  1/3    0    0  1/6
## [2,]    0    0  1/3 -4/3    0    1 -2/3
## [3,]   -2    0   -1    2    1    0    0
## 
##  multiply row 1 by 2 and add to row 3 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    1    0  1/6  1/3    0    0  1/6
## [2,]    0    0  1/3 -4/3    0    1 -2/3
## [3,]    0    0 -2/3  8/3    1    0  1/3
## 
## row: 2 
## 
##  exchange rows 2 and 3 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    1    0  1/6  1/3    0    0  1/6
## [2,]    0    0 -2/3  8/3    1    0  1/3
## [3,]    0    0  1/3 -4/3    0    1 -2/3
## 
##  multiply row 2 by -3/2 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    1    0  1/6  1/3    0    0  1/6
## [2,]    0    0    1   -4 -3/2    0 -1/2
## [3,]    0    0  1/3 -4/3    0    1 -2/3
## 
##  multiply row 2 by 1/6 and subtract from row 1 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    1    0    0    1  1/4    0  1/4
## [2,]    0    0    1   -4 -3/2    0 -1/2
## [3,]    0    0  1/3 -4/3    0    1 -2/3
## 
##  multiply row 2 by 1/3 and subtract from row 3 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    1    0    0    1  1/4    0  1/4
## [2,]    0    0    1   -4 -3/2    0 -1/2
## [3,]    0    0    0    0  1/2    1 -1/2
## 
## row: 3 
## 
## Initial matrix:
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]  1    0    0    1    0    0    0  
## [2,]  0    0    0    0    1    0    0  
## [3,]  0    1    0    0    0    1    0  
## [4,]  1   -4    0    0    0    0    1  
## 
## row: 1 
## 
##  subtract row 1 from row 4 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]  1    0    0    1    0    0    0  
## [2,]  0    0    0    0    1    0    0  
## [3,]  0    1    0    0    0    1    0  
## [4,]  0   -4    0   -1    0    0    1  
## 
## row: 2 
## 
##  exchange rows 2 and 4 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]  1    0    0    1    0    0    0  
## [2,]  0   -4    0   -1    0    0    1  
## [3,]  0    1    0    0    0    1    0  
## [4,]  0    0    0    0    1    0    0  
## 
##  multiply row 2 by -1/4 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    1    0    0    1    0    0    0
## [2,]    0    1    0  1/4    0    0 -1/4
## [3,]    0    1    0    0    0    1    0
## [4,]    0    0    0    0    1    0    0
## 
##  subtract row 2 from row 3 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    1    0    0    1    0    0    0
## [2,]    0    1    0  1/4    0    0 -1/4
## [3,]    0    0    0 -1/4    0    1  1/4
## [4,]    0    0    0    0    1    0    0
## 
## row: 3</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="primer-math.html#cb87-1"></a>B <span class="co"># A^-</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,] -1/8    0  1/8
## [2,]    0    0    0
## [3,]    0    0    0
## [4,]  3/8    0  1/8</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="primer-math.html#cb89-1"></a>A <span class="op">%*%</span><span class="st"> </span>B <span class="op">%*%</span><span class="st"> </span>A <span class="co"># check</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]   -2    0   -1    2
## [2,]    4    0    1    0
## [3,]    6    0    1    2</code></pre>
<p>Notes:</p>
<ul>
<li>Because it uses a maximum-pivot strategy, the procedure implemented by <code>Ginv()</code> is slightly different from that described in the text, and it produces a different generalized inverse for this example. In the steps enumerated in the verbose output, <code>Ginv()</code> first transforms the matrix <code>A</code> to RREF after sticking an identity matrix on the right, and then rather than performing elementary column operations, it does the equivalent by transposing the RREF of A and reducing that to RREF, once again sticking an identity matrix on the right.</li>
<li>Let <span class="math inline">\(\mathbf{E}\)</span> contain the columns originally pertaining to the identity matrix after <code>A</code> is transformed to RREF; and let <span class="math inline">\(\mathbf{E^*}\)</span> contain the <em>transposed</em> rows originally pertaining to the identity matrix after the transpose of the RREF of <code>A</code> is itself reduced to RREF, the transpose of which is the canonical form of <code>A</code>, <span class="math inline">\(\mathbf{A}_C\)</span>. Then the generalized inverse returned by <code>Ginv()</code> is <span class="math inline">\(\mathbf{E^*} \mathbf{A}_C \mathbf{E}\)</span>.</li>
</ul>
<p>The <code>ginv()</code> function in the <strong>MASS</strong> package, which is part of the standard R distribution, computes the Moore-Penrose generalized inverse, and is also more efficient and potentially more accurate than <code>Ginv()</code>:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="primer-math.html#cb91-1"></a><span class="kw">library</span>(<span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb91-2"><a href="primer-math.html#cb91-2"></a><span class="kw">fractions</span>(M &lt;-<span class="st"> </span><span class="kw">ginv</span>(A)) <span class="co"># A^+</span></span></code></pre></div>
<pre><code>##      [,1]    [,2]    [,3]   
## [1,] -13/216    2/27  19/216
## [2,]       0       0       0
## [3,]   -5/54    1/27   -1/54
## [4,]  67/216   -2/27  35/216</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="primer-math.html#cb93-1"></a><span class="kw">zapsmall</span>(A <span class="op">%*%</span><span class="st"> </span>M <span class="op">%*%</span><span class="st"> </span>A) <span class="co"># check = A</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]   -2    0   -1    2
## [2,]    4    0    1    0
## [3,]    6    0    1    2</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="primer-math.html#cb95-1"></a><span class="kw">fractions</span>(M <span class="op">%*%</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>M) <span class="co"># check = M</span></span></code></pre></div>
<pre><code>##      [,1]    [,2]    [,3]   
## [1,] -13/216    2/27  19/216
## [2,]       0       0       0
## [3,]   -5/54    1/27   -1/54
## [4,]  67/216   -2/27  35/216</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="primer-math.html#cb97-1"></a><span class="kw">fractions</span>(A <span class="op">%*%</span><span class="st"> </span>M) <span class="co"># check symmetry</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  5/6 -1/3  1/6
## [2,] -1/3  1/3  1/3
## [3,]  1/6  1/3  5/6</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="primer-math.html#cb99-1"></a><span class="kw">fractions</span>(M <span class="op">%*%</span><span class="st"> </span>A) <span class="co"># check symmetry</span></span></code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]  [,4] 
## [1,] 17/18     0   2/9  1/18
## [2,]     0     0     0     0
## [3,]   2/9     0   1/9  -2/9
## [4,]  1/18     0  -2/9 17/18</code></pre>
<p>The <code>zapsmall()</code> function rounds very small numbers to zero.</p>
</div>
<div id="chapter-2-matrix-decompositions-and-quadratic-forms" class="section level2">
<h2><span class="header-section-number">16.8</span> Chapter 2: Matrix Decompositions and Quadratic Forms</h2>
</div>
<div id="eigenvalues-and-eigenvectors" class="section level2">
<h2><span class="header-section-number">16.9</span> Eigenvalues and Eigenvectors</h2>
<p>The <code>Eigen()</code> function in the <strong>matlib</strong> package computes eigenvalues and normalized eigenvectors of square symmetric matrices using the iterated QR decomposition (as described in Section 2.3.1 of the text). In contrast to the standard-R <code>eigen()</code> function, <code>Eigen()</code> is implemented purely in R code and therefore can easily be inspected by the user. Both functions return lists with elements giving eigenvalues and normalized eigenvectors. For example:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="primer-math.html#cb101-1"></a>(A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  1.0  0.5
## [2,]  0.5  1.0</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="primer-math.html#cb103-1"></a>(X.eig &lt;-<span class="st"> </span><span class="kw">eigen</span>(A))</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
## [1] 1.5 0.5
## 
## $vectors
##           [,1]       [,2]
## [1,] 0.7071068 -0.7071068
## [2,] 0.7071068  0.7071068</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="primer-math.html#cb105-1"></a>(X.Eig &lt;-<span class="st"> </span><span class="kw">Eigen</span>(A))</span></code></pre></div>
<pre><code>## $values
## [1] 1.5 0.5
## 
## $vectors
##            [,1]       [,2]
## [1,] -0.7071068  0.7071068
## [2,] -0.7071068 -0.7071068</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="primer-math.html#cb107-1"></a>X.eig<span class="op">$</span>vectors <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(X.eig<span class="op">$</span>values) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(X.eig<span class="op">$</span>vectors) <span class="co"># check = A</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  1.0  0.5
## [2,]  0.5  1.0</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="primer-math.html#cb109-1"></a>X.Eig<span class="op">$</span>vectors <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(X.Eig<span class="op">$</span>values) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(X.Eig<span class="op">$</span>vectors) <span class="co"># ditto</span></span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  1.0  0.5
## [2,]  0.5  1.0</code></pre>
<p>The two functions return similar results, with the eigenvectors produced by <code>Eigen()</code> the reflection of those produced by <code>eigen()</code>. Recall that normalized eigenvalues are defined uniquely up to a change in sign.</p>
</div>
<div id="the-cholesky-decomposition" class="section level2">
<h2><span class="header-section-number">16.10</span> The Cholesky Decomposition</h2>
<p>Similarly, the <strong>cholesky()</strong> function in the <strong>matlib</strong> package and the standard-R <strong>chol</strong> function compute the Cholesky decomposition of a square symmetric matrix, the former using pure R code. Demosntrating with the example given in the text:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="primer-math.html#cb111-1"></a>(A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="dv">3</span>, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  1.0  0.5  0.3
## [2,]  0.5  1.0  0.5
## [3,]  0.3  0.5  1.0</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="primer-math.html#cb113-1"></a>(L &lt;-<span class="st"> </span><span class="kw">cholesky</span>(A))</span></code></pre></div>
<pre><code>##      [,1]      [,2]      [,3]
## [1,]  1.0 0.0000000 0.0000000
## [2,]  0.5 0.8660254 0.0000000
## [3,]  0.3 0.4041452 0.8640988</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="primer-math.html#cb115-1"></a>(U &lt;-<span class="st"> </span><span class="kw">chol</span>(A))</span></code></pre></div>
<pre><code>##      [,1]      [,2]      [,3]
## [1,]    1 0.5000000 0.3000000
## [2,]    0 0.8660254 0.4041452
## [3,]    0 0.0000000 0.8640988</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="primer-math.html#cb117-1"></a>L <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(L) <span class="co"># check = A</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  1.0  0.5  0.3
## [2,]  0.5  1.0  0.5
## [3,]  0.3  0.5  1.0</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="primer-math.html#cb119-1"></a><span class="kw">t</span>(U) <span class="op">%*%</span><span class="st"> </span>U <span class="co"># ditto</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  1.0  0.5  0.3
## [2,]  0.5  1.0  0.5
## [3,]  0.3  0.5  1.0</code></pre>
<p>The functions differ in that <code>chol()</code> returns the upper-triangular Cholesky factor (as in the text), while <code>cholesky()</code> returns the lower-triangular Cholesky factor.</p>
</div>
<div id="the-qr-decomposition" class="section level2">
<h2><span class="header-section-number">16.11</span> The QR Decomposition</h2>
<p>The <code>QR()</code> function in the <strong>matlib</strong> package once again is a pure-R implementation of a standard-R function, <code>qr()</code>, and as their names imply, both functions compute the QR factorization of a rectangular matrix. <code>QR()</code> returns a list with the Q and R components and the rank of the matrix. The object returned by <code>qr()</code> is more complicated, but the Q and R components can be computed from it. Using the illustrative matrix in the text:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="primer-math.html#cb121-1"></a>(X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>,</span>
<span id="cb121-2"><a href="primer-math.html#cb121-2"></a>              <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">4</span>,</span>
<span id="cb121-3"><a href="primer-math.html#cb121-3"></a>              <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">6</span>,</span>
<span id="cb121-4"><a href="primer-math.html#cb121-4"></a>              <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">8</span>),</span>
<span id="cb121-5"><a href="primer-math.html#cb121-5"></a>            <span class="dv">4</span>, <span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    1    2
## [2,]    1    1    4
## [3,]    1    0    6
## [4,]    1    0    8</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="primer-math.html#cb123-1"></a>(QR.X &lt;-<span class="st"> </span><span class="kw">QR</span>(X))</span></code></pre></div>
<pre><code>## $Q
##      [,1] [,2] [,3]
## [1,] -0.5 -0.5  0.5
## [2,] -0.5 -0.5 -0.5
## [3,] -0.5  0.5  0.5
## [4,] -0.5  0.5 -0.5
## 
## $R
##      [,1] [,2] [,3]
## [1,]   -2   -1  -10
## [2,]    0   -1    4
## [3,]    0    0   -2
## 
## $rank
## [1] 3</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="primer-math.html#cb125-1"></a>QR.X<span class="op">$</span>Q <span class="op">%*%</span><span class="st"> </span>QR.X<span class="op">$</span>R <span class="co"># check =X</span></span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    1    2
## [2,]    1    1    4
## [3,]    1    0    6
## [4,]    1    0    8</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="primer-math.html#cb127-1"></a>qr.X &lt;-<span class="st"> </span><span class="kw">qr</span>(X)</span>
<span id="cb127-2"><a href="primer-math.html#cb127-2"></a><span class="kw">names</span>(qr.X)</span></code></pre></div>
<pre><code>## [1] &quot;qr&quot;    &quot;rank&quot;  &quot;qraux&quot; &quot;pivot&quot;</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="primer-math.html#cb129-1"></a>qr.X<span class="op">$</span>rank</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="primer-math.html#cb131-1"></a><span class="kw">qr.Q</span>(qr.X)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,] -0.5 -0.5  0.5
## [2,] -0.5 -0.5 -0.5
## [3,] -0.5  0.5  0.5
## [4,] -0.5  0.5 -0.5</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="primer-math.html#cb133-1"></a><span class="kw">qr.R</span>(qr.X)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   -2   -1  -10
## [2,]    0   -1    4
## [3,]    0    0   -2</code></pre>
</div>
<div id="chapter-3.-an-introduction-to-calculus" class="section level2">
<h2><span class="header-section-number">16.12</span> Chapter 3. An Introduction to Calculus</h2>
<p>As mentioned, the standard R distribution has limited facilities for symbolic mathematics, including calculus. Although there are contributed R packages on CRAN that link R to open-source symbolic algebra systems <span class="citation">[for example, the **Ryacas** package, @AndersenHojsgaard2019, which interfaces R to the *yacas* symbolic algebra system]</span>, these aren’t very easy to use. In contrast, the contributed <strong>mosaicCalc</strong> package modestly augments the symbolic math capabilities of R, and I’ll focus on this package here.</p>
<p>The <code>D()</code> function the <strong>mosaicCalc</strong> package is capable of finding derivatives and partial derivatives for all of the examples presented in the text, which the slight caveat that <code>D()</code> doesn’t simplify the resulting expressions. There is also a somewhat less convenient <code>D()</code> function for differentiation in the standard R distribution that <code>D()</code> in <strong>mosaicCalc</strong> ‘masks’ (i.e., hides). For example, for <span class="math inline">\(y = f(x) = x^2\)</span>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="primer-math.html#cb135-1"></a><span class="kw">library</span>(<span class="st">&quot;mosaicCalc&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: package &#39;mosaicCalc&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Loading required package: mosaicCore</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;mosaic&#39;:
##   method                           from   
##   fortify.SpatialPolygonsDataFrame ggplot2</code></pre>
<pre><code>## 
## Attaching package: &#39;mosaicCalc&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     D</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="primer-math.html#cb141-1"></a>(dy_dx &lt;-<span class="st"> </span><span class="kw">D</span>(x<span class="op">^</span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>x))</span></code></pre></div>
<pre><code>## function (x) 
## 2 * x</code></pre>
<p>The argument to <code>D()</code> is a <em>formula</em>, where left-hand side (i.e., the component to the left of the tilde, <code>~</code>) is the function to be differentiated, here <code>x^2</code>, and the right-hand side is the independent variable, <code>x</code>. The result is an R function, which may be used to compute the derivative for specific values of the independent variable; for example,</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="primer-math.html#cb143-1"></a><span class="kw">dy_dx</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 2 4 6</code></pre>
<p>returns the value of <span class="math inline">\(dy/dx = 2x\)</span> for <span class="math inline">\(x = 1, 2\)</span>, and 3.</p>
<p>The other derivative examples in the text are evaluated as follows:</p>
<ul>
<li><span class="math inline">\(f(x) = 3x^6\)</span></li>
</ul>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="primer-math.html#cb145-1"></a><span class="kw">D</span>(<span class="dv">3</span><span class="op">*</span>x<span class="op">^</span><span class="dv">6</span> <span class="op">~</span><span class="st"> </span>x)  <span class="co"># note: not simplified!</span></span></code></pre></div>
<pre><code>## function (x) 
## 3 * (6 * x^5)</code></pre>
<ul>
<li><span class="math inline">\(f(x) = \frac{1}{4x^3} = \frac{1}{4} x^{-3}\)</span></li>
</ul>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="primer-math.html#cb147-1"></a><span class="kw">D</span>((<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>x<span class="op">^-</span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span>x) <span class="co"># again not simplified</span></span></code></pre></div>
<pre><code>## function (x) 
## -((1/4) * (x^-(3 + 1) * 3))</code></pre>
<ul>
<li><span class="math inline">\(f(x) = \sqrt{x} = x^{1/2}\)</span></li>
</ul>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="primer-math.html#cb149-1"></a><span class="kw">D</span>(x<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">~</span><span class="st"> </span>x)</span></code></pre></div>
<pre><code>## function (x) 
## x^((1/2) - 1) * (1/2)</code></pre>
<ul>
<li>The addition rule, applied to <span class="math inline">\(f(x) = 2x^2 + 3x + 4\)</span></li>
</ul>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="primer-math.html#cb151-1"></a><span class="kw">D</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span>x)</span></code></pre></div>
<pre><code>## function (x) 
## 2 * (2 * x) + 3</code></pre>
<ul>
<li>The multiplication rule, applied to <span class="math inline">\(f(x) = (x^2 + 1)(2x^3 - 3x)\)</span></li>
</ul>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="primer-math.html#cb153-1"></a><span class="kw">D</span>((x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x) <span class="op">~</span><span class="st"> </span>x)</span></code></pre></div>
<pre><code>## function (x) 
## 2 * x * (2 * x^3 - 3 * x) + (x^2 + 1) * (2 * (3 * x^2) - 3)</code></pre>
<ul>
<li>The division rule, applied to <span class="math inline">\(x/(x^2 - 3*x +5)\)</span></li>
</ul>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="primer-math.html#cb155-1"></a><span class="co"># following is equivalent to f&#39;(x) = (-(x^2) + 5)/((x^2 - 3*x + 5)^2):</span></span>
<span id="cb155-2"><a href="primer-math.html#cb155-2"></a><span class="kw">D</span>(x<span class="op">/</span>(x<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x <span class="op">+</span><span class="dv">5</span>) <span class="op">~</span><span class="st"> </span>x)</span></code></pre></div>
<pre><code>## function (x) 
## 1/(x^2 - 3 * x + 5) - x * (2 * x - 3)/(x^2 - 3 * x + 5)^2</code></pre>
<ul>
<li>The chain rule, applied to <span class="math inline">\((x^2 + 3x + 6)^5\)</span></li>
</ul>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="primer-math.html#cb157-1"></a><span class="kw">D</span>((x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)<span class="op">^</span><span class="dv">5</span> <span class="op">~</span><span class="st"> </span>x)</span></code></pre></div>
<pre><code>## function (x) 
## 5 * ((2 * x + 3) * (x^2 + 3 * x + 6)^4)</code></pre>
<ul>
<li>The derivative of the log function, <span class="math inline">\(f(x) = \log_e(x)\)</span></li>
</ul>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="primer-math.html#cb159-1"></a><span class="kw">D</span>(<span class="kw">log</span>(x) <span class="op">~</span><span class="st"> </span>x)</span></code></pre></div>
<pre><code>## function (x) 
## 1/x</code></pre>
<ul>
<li>The derivative of the the exponential function, <span class="math inline">\(f(x) = e^x\)</span></li>
</ul>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="primer-math.html#cb161-1"></a><span class="kw">D</span>(<span class="kw">exp</span>(x) <span class="op">~</span><span class="st"> </span>x)</span></code></pre></div>
<pre><code>## function (x) 
## exp(x)</code></pre>
<ul>
<li>The derivative of <span class="math inline">\(f(x) = a^x\)</span></li>
</ul>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="primer-math.html#cb163-1"></a><span class="kw">D</span>(a<span class="op">^</span>x <span class="op">~</span><span class="st"> </span>x) <span class="co"># note: returns a function of x and a</span></span></code></pre></div>
<pre><code>## function (x, a) 
## a^x * log(a)</code></pre>
<ul>
<li>The derivatives of common trigonometric functions:</li>
</ul>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="primer-math.html#cb165-1"></a><span class="kw">D</span>(<span class="kw">cos</span>(x) <span class="op">~</span><span class="st"> </span>x)</span></code></pre></div>
<pre><code>## function (x) 
## -sin(x)</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="primer-math.html#cb167-1"></a><span class="kw">D</span>(<span class="kw">sin</span>(x) <span class="op">~</span><span class="st"> </span>x)</span></code></pre></div>
<pre><code>## function (x) 
## cos(x)</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="primer-math.html#cb169-1"></a><span class="kw">D</span>(<span class="kw">tan</span>(x) <span class="op">~</span><span class="st"> </span>x)</span></code></pre></div>
<pre><code>## function (x) 
## 1/cos(x)^2</code></pre>
<p>Second and higher-order derivatives can be evaluated by specifying the independent variable repeatedly on the right-hand side of the derivative formula (separated by pluses). For example, for <span class="math inline">\(f(x) = 5x^4 + 3x^2 + 6\)</span>:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="primer-math.html#cb171-1"></a><span class="kw">D</span>(<span class="dv">5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">~</span><span class="st"> </span>x) <span class="co"># f&#39;(x)</span></span></code></pre></div>
<pre><code>## function (x) 
## 5 * (4 * x^3) + 3 * (2 * x)</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="primer-math.html#cb173-1"></a><span class="kw">D</span>(<span class="dv">5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x) <span class="co"># f&#39;&#39;(x)</span></span></code></pre></div>
<pre><code>## function (x) 
## 5 * (4 * (3 * x^2)) + 3 * 2</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="primer-math.html#cb175-1"></a><span class="kw">D</span>(<span class="dv">5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x) <span class="co"># f&#39;&#39;&#39;(x)</span></span></code></pre></div>
<pre><code>## function (x) 
## 5 * (4 * (3 * (2 * x)))</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="primer-math.html#cb177-1"></a><span class="kw">D</span>(<span class="dv">5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x) <span class="co"># f&#39;&#39;&#39;&#39;(x)</span></span></code></pre></div>
<pre><code>## function (x) 
## 5 * (4 * (3 * 2))</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="primer-math.html#cb179-1"></a><span class="kw">D</span>(<span class="dv">5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x) <span class="co"># f&#39;&#39;&#39;&#39;&#39;(x)</span></span></code></pre></div>
<pre><code>## function (x) 
## 0</code></pre>
</div>
<div id="maximization-and-minimization" class="section level2">
<h2><span class="header-section-number">16.13</span> Maximization and Minimization</h2>
<p>To find extrema of a function, we not only have to differentiate the function but also must set the derivative to zero and solve the resulting equation for its roots. The standard R distribution has two root-finding functions: <code>unitroot()</code>, which will try to find <em>one</em> root of an arbitrary function in a prespecified range of <span class="math inline">\(x\)</span> values, and <code>polyroot()</code> which locates the roots of a polynomial function.</p>
<p>The example given in the text is a polynomial function, <span class="math inline">\(f(x) = 2x^3 - 9x^2 + 12x + 6\)</span>, and so its derivative is also a polynomial:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="primer-math.html#cb181-1"></a><span class="kw">D</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="dv">9</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">12</span><span class="op">*</span>x <span class="op">+</span><span class="dv">6</span> <span class="op">~</span><span class="st"> </span>x)</span></code></pre></div>
<pre><code>## function (x) 
## 2 * (3 * x^2) - 9 * (2 * x) + 12</code></pre>
<p>The function returned by <code>D()</code> isn’t in the form required by <code>polyroot()</code>, whose argument is the <em>vector</em> of coefficients of the polynomial, <span class="math inline">\(a_0, a_1, \ldots, a_n\)</span> for a polynomial of degree <span class="math inline">\(n\)</span>. Thus, for the current example:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="primer-math.html#cb183-1"></a><span class="kw">polyroot</span>(<span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">-18</span>, <span class="dv">6</span>))</span></code></pre></div>
<pre><code>## [1] 1+0i 2-0i</code></pre>
<p><code>polyroot()</code> returns the roots of the polynomial as complex numbers. In this case, the imaginary parts of the two roots are both zero, and consequently the roots are real, <span class="math inline">\(x = 1\)</span> and <span class="math inline">\(x = 2\)</span>. The corresponding <span class="math inline">\(y\)</span>-values are 11 and 10:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="primer-math.html#cb185-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="dv">9</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">12</span><span class="op">*</span>x <span class="op">+</span><span class="dv">6</span></span>
<span id="cb185-2"><a href="primer-math.html#cb185-2"></a><span class="kw">f</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 11 10</code></pre>
<p>To figure out whether these values are relative minima, maxima, or neither, let’s find the second derivative of the function and determine whether it’s positive, negative, or zero at the stationary points:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="primer-math.html#cb187-1"></a>(fpp &lt;-<span class="st"> </span><span class="kw">D</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="dv">9</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">12</span><span class="op">*</span>x <span class="op">+</span><span class="dv">6</span> <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x))</span></code></pre></div>
<pre><code>## function (x) 
## 2 * (3 * (2 * x)) - 9 * 2</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="primer-math.html#cb189-1"></a><span class="kw">fpp</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] -6  6</code></pre>
<p><span class="math inline">\(y = 11\)</span> is a relative maximum at <span class="math inline">\(x = 1\)</span> because <span class="math inline">\(f&#39;&#39;(1) = -6 &lt; 0\)</span>, and <span class="math inline">\(y = 10\)</span> is a relative minimum at <span class="math inline">\(x = 2\)</span> because <span class="math inline">\(f&#39;&#39;(2) = 6 &gt; 0\)</span>.</p>
<p>Finally, let’s draw the function near the minimum and maximum, adding reference lines:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="primer-math.html#cb191-1"></a><span class="kw">curve</span>(<span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="dv">9</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">12</span><span class="op">*</span>x <span class="op">+</span><span class="dv">6</span>, <span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">3</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">15</span>),</span>
<span id="cb191-2"><a href="primer-math.html#cb191-2"></a>      <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x) <span class="op">==</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="dv">9</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">12</span><span class="op">*</span>x <span class="op">+</span><span class="dv">6</span>))</span>
<span id="cb191-3"><a href="primer-math.html#cb191-3"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">11</span>), <span class="dt">v=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="partial-derivatives" class="section level2">
<h2><span class="header-section-number">16.14</span> Partial Derivatives</h2>
<p>Although, as we’ve seen, R has good linear algebra facilities, neither the standard R system nor the <strong>mosaicCalc</strong> package supports matrix calculus. We can, however, use <code>D()</code> to compute partial derivatives. For example, for the function <span class="math inline">\(y = f(x_1, x_2) = x_1^2 + 3x_1 x_2^2 + x_2^2\)</span>, the partial derivatives with respect to <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="primer-math.html#cb192-1"></a><span class="kw">D</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x_<span class="dv">1</span><span class="op">*</span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span>x_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## function (x_1, x_2) 
## 2 * x_1 + 3 * x_2^2</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="primer-math.html#cb194-1"></a><span class="kw">D</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x_<span class="dv">1</span><span class="op">*</span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span>x_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## function (x_2, x_1) 
## 3 * x_1 * (2 * x_2) + 3 * x_2^2</code></pre>
<p>As before, <code>D()</code> doesn’t simplify the result of <span class="math inline">\(\partial y/\partial x_2\)</span>.</p>
<p>To minimize the function <span class="math inline">\(f(x_1, x_2) = x_1^2 + x_1 x_2 + x_2^2 + 10\)</span>, we find its partial derivatives with respect to <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="primer-math.html#cb196-1"></a>(fp1 &lt;-<span class="st"> </span><span class="kw">D</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">1</span><span class="op">*</span>x_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">~</span><span class="st"> </span>x_<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## function (x_1, x_2) 
## 2 * x_1 + x_2</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="primer-math.html#cb198-1"></a>(fp2 &lt;-<span class="st"> </span><span class="kw">D</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">1</span><span class="op">*</span>x_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">~</span><span class="st"> </span>x_<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## function (x_2, x_1) 
## x_1 + 2 * x_2</code></pre>
<p>We then set the partial derivatives to zero and solve the resulting pair of linear simultaneous equations:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="primer-math.html#cb200-1"></a>(A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    2    1
## [2,]    1    2</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="primer-math.html#cb202-1"></a><span class="kw">solve</span>(A, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span></code></pre></div>
<pre><code>## [1] 0 0</code></pre>
<p>Thus, there’s a stationary point at <span class="math inline">\(x_1 = 0, x_2 = 0\)</span>, where <span class="math inline">\(y\)</span> is</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="primer-math.html#cb204-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x_<span class="dv">1</span>, x_<span class="dv">2</span>) x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">1</span><span class="op">*</span>x_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span></span>
<span id="cb204-2"><a href="primer-math.html#cb204-2"></a><span class="kw">f</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<p>We can also use the partial derivatives, saved in the R functions <code>fp1()</code> and <code>fp2()</code>, to find the slopes of the tagent plane to <span class="math inline">\(f(x_1, x_2)\)</span> above an arbitrary pair of <span class="math inline">\(x\)</span>-values; for example, for <span class="math inline">\(x_1 = 1\)</span> and <span class="math inline">\(x_2 = 2\)</span>, the slopes are</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="primer-math.html#cb206-1"></a><span class="kw">fp1</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="primer-math.html#cb208-1"></a><span class="kw">fp2</span>(<span class="dv">2</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>Notice that the arguments of <code>fp2()</code> are in the order <code>x_2</code>, <code>x_1</code>.</p>
</div>
<div id="lagrange-multipliers-for-constrained-optimization" class="section level2">
<h2><span class="header-section-number">16.15</span> Lagrange Multipliers for Constrained Optimization</h2>
<p>The Lagrange multiplier example in the text can also be solved straightforwardly because the derivatives produce a linear system of simultaneous equations. Here the object is to minimize <span class="math inline">\(y = f(x_1, x_2) = x_1^2 + x_2^2\)</span> subject to the constraint <span class="math inline">\(g(x_1, x_2) = x_1 + x_2 - 1 = 0\)</span>. Then <span class="math inline">\(h(x_1, x_2, \lambda) = x_1^2 + x_2^2 - \lambda(x_1 + x_2 - 1)\)</span>. Translating this into R code:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="primer-math.html#cb210-1"></a><span class="kw">D</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>lambda<span class="op">*</span>(x_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">~</span><span class="st"> </span>x_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## function (x_1, x_2, lambda) 
## 2 * x_1 - lambda</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="primer-math.html#cb212-1"></a><span class="kw">D</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>lambda<span class="op">*</span>(x_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">~</span><span class="st"> </span>x_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## function (x_2, x_1, lambda) 
## 2 * x_2 - lambda</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="primer-math.html#cb214-1"></a><span class="kw">D</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>lambda<span class="op">*</span>(x_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">~</span><span class="st"> </span>lambda)</span></code></pre></div>
<pre><code>## function (lambda, x_1, x_2) 
## -(x_1 + x_2 - 1)</code></pre>
<p>Solving,</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="primer-math.html#cb216-1"></a>(A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">-1</span>,</span>
<span id="cb216-2"><a href="primer-math.html#cb216-2"></a>               <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">-1</span>,</span>
<span id="cb216-3"><a href="primer-math.html#cb216-3"></a>              <span class="dv">-1</span>,<span class="op">-</span><span class="dv">1</span>,  <span class="dv">0</span>),</span>
<span id="cb216-4"><a href="primer-math.html#cb216-4"></a>             <span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    2    0   -1
## [2,]    0    2   -1
## [3,]   -1   -1    0</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="primer-math.html#cb218-1"></a><span class="kw">solve</span>(A, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">-1</span>))</span></code></pre></div>
<pre><code>## [1] 0.5 0.5 1.0</code></pre>
<p>That is, <span class="math inline">\(x_1 = 0.5, x_2 = 0.5, \lambda = 1\)</span>.</p>
<p>As I mentioned, the <strong>mosaicCalc</strong> package doesn’t directly support symbolic matrix differential calculus, but it does allow to to find second partial derivatives of functions of more than one independent variable, including cross-derivatives. For example, for the function <span class="math inline">\(f(x_1, x_2) = x_1^2 + x_1 x_2 + x_2^2 + 10\)</span> considered above, we can find <span class="math inline">\(\frac{\partial^2 y}{\partial x_1 \partial x_2} = \frac{\partial^2 y}{\partial x_2 \partial x_1}\)</span>, <span class="math inline">\(\frac{\partial^2 y}{\partial x_1^2}\)</span>, and <span class="math inline">\(\frac{\partial^2 y}{\partial x_2^2}\)</span>:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="primer-math.html#cb220-1"></a><span class="kw">D</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">1</span><span class="op">*</span>x_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">~</span><span class="st"> </span>x_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## function (x_1, x_2) 
## 1</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="primer-math.html#cb222-1"></a><span class="kw">D</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">1</span><span class="op">*</span>x_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">~</span><span class="st"> </span>x_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## function (x_2, x_1) 
## 1</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="primer-math.html#cb224-1"></a><span class="kw">D</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">1</span><span class="op">*</span>x_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">~</span><span class="st"> </span>x_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## function (x_1, x_2) 
## 2</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="primer-math.html#cb226-1"></a><span class="kw">D</span>(x_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">1</span><span class="op">*</span>x_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">10</span> <span class="op">~</span><span class="st"> </span>x_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## function (x_2, x_1) 
## 2</code></pre>
<p>For this example, all of the second derivatives are constants, but that is not generally the case.</p>
</div>
<div id="numerical-optimization" class="section level2">
<h2><span class="header-section-number">16.16</span> Numerical Optimization</h2>
<p>The standard R distribution has reasonably good facilities for numerical optimization. See, in particular, <code>optimize()</code> for optimizing a function of a single independent variable, and <code>optim()</code> for optimizing a function of several independent variables. The contributed <strong>optimix</strong> package <span class="citation">[@Nash2014]</span> provides a more extensive suite of optimization tools.</p>
<p>Here is a simple (indeed, simple-minded) minimization function that implements the gradient-descent method described in the text:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="primer-math.html#cb228-1"></a>minimize &lt;-<span class="st"> </span><span class="cf">function</span>(f, df, x0, <span class="dt">tol=</span><span class="fl">1e-5</span>, <span class="dt">adjust.step=</span><span class="ot">TRUE</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>){</span>
<span id="cb228-2"><a href="primer-math.html#cb228-2"></a>    <span class="co"># f:           function to be minimized</span></span>
<span id="cb228-3"><a href="primer-math.html#cb228-3"></a>    <span class="co"># df:          function for the vector partial derivative (gradient) of f</span></span>
<span id="cb228-4"><a href="primer-math.html#cb228-4"></a>    <span class="co"># x0:          vector of starting values for x</span></span>
<span id="cb228-5"><a href="primer-math.html#cb228-5"></a>    <span class="co"># tol:         a small positive number to test for convergence,</span></span>
<span id="cb228-6"><a href="primer-math.html#cb228-6"></a>    <span class="co">#              to be treated as effectively zero</span></span>
<span id="cb228-7"><a href="primer-math.html#cb228-7"></a>    <span class="co"># adjust.step: if TRUE, adjust the step size if there is no improvement</span></span>
<span id="cb228-8"><a href="primer-math.html#cb228-8"></a>    <span class="co"># verbose:     if TRUE, print iteration history</span></span>
<span id="cb228-9"><a href="primer-math.html#cb228-9"></a>    it &lt;-<span class="st"> </span>0L</span>
<span id="cb228-10"><a href="primer-math.html#cb228-10"></a>    step &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb228-11"><a href="primer-math.html#cb228-11"></a>    x &lt;-<span class="st"> </span>x0</span>
<span id="cb228-12"><a href="primer-math.html#cb228-12"></a>    <span class="cf">if</span> (verbose){</span>
<span id="cb228-13"><a href="primer-math.html#cb228-13"></a>        <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">it =&quot;</span>, it,<span class="st">&quot;  step =&quot;</span>, step, <span class="st">&quot;  x =&quot;</span>, x0, </span>
<span id="cb228-14"><a href="primer-math.html#cb228-14"></a>            <span class="st">&quot;  f(x) =&quot;</span>, <span class="kw">f</span>(x0), <span class="st">&quot;  f&#39;(x) =&quot;</span>, <span class="kw">df</span>(x0))</span>
<span id="cb228-15"><a href="primer-math.html#cb228-15"></a>    }</span>
<span id="cb228-16"><a href="primer-math.html#cb228-16"></a>    <span class="cf">while</span> (<span class="kw">abs</span>(<span class="kw">df</span>(x)) <span class="op">&gt;</span><span class="st"> </span>tol){</span>
<span id="cb228-17"><a href="primer-math.html#cb228-17"></a>        it &lt;-<span class="st"> </span>it <span class="op">+</span><span class="st"> </span>1L</span>
<span id="cb228-18"><a href="primer-math.html#cb228-18"></a>        x1 &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span>step<span class="op">*</span><span class="kw">fp</span>(x)</span>
<span id="cb228-19"><a href="primer-math.html#cb228-19"></a>        <span class="cf">if</span> (<span class="kw">f</span>(x1) <span class="op">&lt;</span><span class="st"> </span><span class="kw">f</span>(x)){</span>
<span id="cb228-20"><a href="primer-math.html#cb228-20"></a>            x &lt;-<span class="st"> </span>x1</span>
<span id="cb228-21"><a href="primer-math.html#cb228-21"></a>            <span class="cf">if</span> (verbose){</span>
<span id="cb228-22"><a href="primer-math.html#cb228-22"></a>                <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">it =&quot;</span>, it,<span class="st">&quot;  step =&quot;</span>, step, <span class="st">&quot;  x =&quot;</span>, x, </span>
<span id="cb228-23"><a href="primer-math.html#cb228-23"></a>                    <span class="st">&quot;  f(x) =&quot;</span>, <span class="kw">f</span>(x), <span class="st">&quot;  f&#39;(x) =&quot;</span>, <span class="kw">df</span>(x))</span>
<span id="cb228-24"><a href="primer-math.html#cb228-24"></a>            }</span>
<span id="cb228-25"><a href="primer-math.html#cb228-25"></a>            <span class="cf">if</span> (adjust.step) {</span>
<span id="cb228-26"><a href="primer-math.html#cb228-26"></a>                step &lt;-<span class="st"> </span>step<span class="op">*</span><span class="dv">2</span></span>
<span id="cb228-27"><a href="primer-math.html#cb228-27"></a>                <span class="cf">if</span> (verbose){</span>
<span id="cb228-28"><a href="primer-math.html#cb228-28"></a>                    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">  adjusted (*2) step =&quot;</span>, step)</span>
<span id="cb228-29"><a href="primer-math.html#cb228-29"></a>                }</span>
<span id="cb228-30"><a href="primer-math.html#cb228-30"></a>            }</span>
<span id="cb228-31"><a href="primer-math.html#cb228-31"></a>        } <span class="cf">else</span> {</span>
<span id="cb228-32"><a href="primer-math.html#cb228-32"></a>            step &lt;-<span class="st"> </span>step<span class="op">/</span><span class="dv">2</span></span>
<span id="cb228-33"><a href="primer-math.html#cb228-33"></a>            <span class="cf">if</span> (verbose){</span>
<span id="cb228-34"><a href="primer-math.html#cb228-34"></a>                <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">  adjusted (/2) step =&quot;</span>, step)</span>
<span id="cb228-35"><a href="primer-math.html#cb228-35"></a>            }</span>
<span id="cb228-36"><a href="primer-math.html#cb228-36"></a>            it &lt;-<span class="st"> </span>it <span class="op">-</span><span class="st"> </span>1L</span>
<span id="cb228-37"><a href="primer-math.html#cb228-37"></a>        }</span>
<span id="cb228-38"><a href="primer-math.html#cb228-38"></a>    }</span>
<span id="cb228-39"><a href="primer-math.html#cb228-39"></a>    <span class="co"># return a list with x at the minimum, the minimum, the gradient at the minimum,</span></span>
<span id="cb228-40"><a href="primer-math.html#cb228-40"></a>    <span class="co">#  and the number of iterations required</span></span>
<span id="cb228-41"><a href="primer-math.html#cb228-41"></a>    <span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">f=</span><span class="kw">f</span>(x), <span class="dt">df=</span><span class="kw">df</span>(x), <span class="dt">it=</span>it)</span>
<span id="cb228-42"><a href="primer-math.html#cb228-42"></a>}</span></code></pre></div>
<p>For example, as in the text, let’s try to minimize <span class="math inline">\(f(x) = x^4 - 10x^3 + 35x^2 - 50x + 26\)</span>. The derivative of this function is</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="primer-math.html#cb229-1"></a>(fp &lt;-<span class="st"> </span><span class="kw">D</span>(x<span class="op">^</span><span class="dv">4</span> <span class="op">-</span><span class="st"> </span><span class="dv">10</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">35</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">50</span><span class="op">*</span>x <span class="op">+</span><span class="st"> </span><span class="dv">26</span> <span class="op">~</span><span class="st"> </span>x))</span></code></pre></div>
<pre><code>## function (x) 
## 4 * x^3 - 10 * (3 * x^2) + 35 * (2 * x) - 50</code></pre>
<p>Then using the starting value <span class="math inline">\(x_0 = 3\)</span>,</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="primer-math.html#cb231-1"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">4</span> <span class="op">-</span><span class="st"> </span><span class="dv">10</span><span class="op">*</span>x<span class="op">^</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">35</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">50</span><span class="op">*</span>x <span class="op">+</span><span class="st"> </span><span class="dv">26</span></span>
<span id="cb231-2"><a href="primer-math.html#cb231-2"></a><span class="kw">minimize</span>(f, fp, <span class="dt">x0=</span><span class="dv">3</span>, <span class="dt">verbose=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
## it = 0   step = 1   x = 3   f(x) = 2   f&#39;(x) = -2
##   adjusted (/2) step = 0.5
##   adjusted (/2) step = 0.25
## it = 1   step = 0.25   x = 3.5   f(x) = 1.0625   f&#39;(x) = -1
##   adjusted (*2) step = 0.5
##   adjusted (/2) step = 0.25
##   adjusted (/2) step = 0.125
## it = 2   step = 0.125   x = 3.625   f(x) = 1.000244   f&#39;(x) = 0.0703125
##   adjusted (*2) step = 0.25
##   adjusted (/2) step = 0.125
## it = 3   step = 0.125   x = 3.616211   f(x) = 1.000017   f&#39;(x) = -0.01818595
##   adjusted (*2) step = 0.25
##   adjusted (/2) step = 0.125
## it = 4   step = 0.125   x = 3.618484   f(x) = 1.000001   f&#39;(x) = 0.004504641
##   adjusted (*2) step = 0.25
##   adjusted (/2) step = 0.125
## it = 5   step = 0.125   x = 3.617921   f(x) = 1   f&#39;(x) = -0.001128709
##   adjusted (*2) step = 0.25
##   adjusted (/2) step = 0.125
## it = 6   step = 0.125   x = 3.618062   f(x) = 1   f&#39;(x) = 0.0002820169
##   adjusted (*2) step = 0.25
##   adjusted (/2) step = 0.125
## it = 7   step = 0.125   x = 3.618027   f(x) = 1   f&#39;(x) = -7.051423e-05
##   adjusted (*2) step = 0.25
##   adjusted (/2) step = 0.125
## it = 8   step = 0.125   x = 3.618036   f(x) = 1   f&#39;(x) = 1.762793e-05
##   adjusted (*2) step = 0.25
##   adjusted (/2) step = 0.125
## it = 9   step = 0.125   x = 3.618034   f(x) = 1   f&#39;(x) = -4.407022e-06
##   adjusted (*2) step = 0.25</code></pre>
<pre><code>## $x
## [1] 3.618034
## 
## $f
## [1] 1
## 
## $df
## [1] -4.407022e-06
## 
## $it
## [1] 9</code></pre>
<p>The computation converges to the specified tolerance in nine iterations, at which point <span class="math inline">\(x = 3.618034\)</span> (recall that there is a minimum at <span class="math inline">\(x \approx 3.6180\)</span>), <span class="math inline">\(f(x) = 1\)</span>, and <span class="math inline">\(f&#39;(x) = -4.4 \times 10^{-6}\)</span> is within the convergence tolerance of zero.</p>
<p>Even though the example problem has only a single independent variable, <code>minimize()</code>, like the standard R <code>optim()</code> function, will also work for functions of several independent variables. Here is the solution to the problem provided by <code>optim()</code>:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="primer-math.html#cb234-1"></a><span class="kw">optim</span>(<span class="dv">3</span>, f, <span class="dt">gr=</span>fp, <span class="dt">method=</span><span class="st">&quot;BFGS&quot;</span>)</span></code></pre></div>
<pre><code>## $par
## [1] 3.618012
## 
## $value
## [1] 1
## 
## $counts
## function gradient 
##       13        7 
## 
## $convergence
## [1] 0
## 
## $message
## NULL</code></pre>
<p>That the <code>$convergence</code> element of the result is <code>0</code> indicates that the computation converged to within rounding error of the answer.</p>
<p>The first argument to <code>optim()</code> is the starting value <span class="math inline">\(x_0 = 3\)</span> (more generally, the vector of starting values for the independent variables); the second argument is the function to be minimized; the third argument, <code>gr</code> is the gradient function (here, the second derivative with respect to the single independent variable); and the fourth argument is the name of the optimization method to be used (several are available, see <code>?optim</code>). The <code>optim()</code> function returns nearly the same answer as <code>minimize()</code>, with a bit more rounding error in this case.</p>
<p>Finally, because the problem has only one independent variable, let’s use the standard R <code>optimize()</code> function, which is typically more accurate for such problems, looking for a minimum in the range (0, 4):</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="primer-math.html#cb236-1"></a><span class="kw">optimize</span>(f, <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span></code></pre></div>
<pre><code>## $minimum
## [1] 1.381954
## 
## $objective
## [1] 1</code></pre>
<p>Notice that <code>optimize()</code> finds the minimum at <span class="math inline">\(x \approx 1.3820\)</span> rather than at <span class="math inline">\(x \approx 3.6180\)</span>. To find the latter, we can specify a different range within which to search for the minimum:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="primer-math.html#cb238-1"></a><span class="kw">optimize</span>(f, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>))</span></code></pre></div>
<pre><code>## $minimum
## [1] 3.618041
## 
## $objective
## [1] 1</code></pre>
<p>In each case, the value of the function at the relative minimum, <span class="math inline">\(y = 1\)</span>, is given by the <code>$objective</code> (i.e., objective function) element of the result.</p>
</div>
<div id="integration" class="section level2">
<h2><span class="header-section-number">16.17</span> Integration</h2>
<p>The <strong>mosaicCalc</strong> package includes the <code>antiD()</code> function for symbolic antidifferentiation—that is, finding indefinite integrals. Usage is similar to the <code>D()</code> function. For exammple, to find the antiderivative of the function <span class="math inline">\(f(x) = x^2 + 3\)</span>,</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="primer-math.html#cb240-1"></a>(F &lt;-<span class="st"> </span><span class="kw">antiD</span>(x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span>x))</span></code></pre></div>
<pre><code>## function (x, C = 0) 
## 1/3 * x^3 + 3 * x + C</code></pre>
<p>The function returned (i.e, <code>F()</code>), which can be used in the normal manner to evaluate definite integrals, includes the arbitrary constant of integration <code>C</code> as an additional argument, set to zero by default. For example, to evaluate the definite integral <span class="math inline">\(\int_1^3 (x^2 + 3)dx\)</span>:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="primer-math.html#cb242-1"></a><span class="kw">F</span>(<span class="dv">3</span>) <span class="op">-</span><span class="st"> </span><span class="kw">F</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 14.66667</code></pre>
<p>The standard R distribution includes the <code>integrate()</code> function for numerical integration of a function of a single independent variable; <code>integrate()</code> works by a more sophisticated version of Figure 3.20 in the text, approximating the area under a function by summing the areas of rectangles (or better, trapezoids) drawn under the function, a method called <em>quadrature</em>. Applied to our example:</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="primer-math.html#cb244-1"></a><span class="kw">integrate</span>(<span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span>}, <span class="dt">lower=</span><span class="dv">1</span>, <span class="dt">upper=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## 14.66667 with absolute error &lt; 1.6e-13</code></pre>
</div>
<div id="chapter-5.-common-probability-distributions" class="section level2">
<h2><span class="header-section-number">16.18</span> Chapter 5. Common Probability Distributions</h2>
<p>The standard R installation includes all of the univariate discrete and continuous probability distribution families discussed in this chapter along with the multinomial distribution, but not the multivariate-normal and Wishart distributions, which are, however, available in contributed packages on CRAN (see below for the multivariate-normal distribution). A common naming convention is used for probability functions: Each distributional family is denoted by a base name—for example, “<code>binom</code>” for the binomial family and “<code>norm</code>” for the normal family. The probability-mass or density function for the family begins with the letter “<code>d</code>”—for example, <code>dbinom()</code> is the binomial mass function and <code>dnorm()</code> is the normal density function. Similarly, the quantile function for a family begins with “<code>q</code>” (<code>qbinom()</code>, <code>qnorm()</code>), the cumulative distribution function begins with “<code>p</code>” (<code>pbinom()</code>, <code>pnorm()</code>), and a pseudo-random number generator begins with “<code>r</code>” (<code>rbinom()</code>, <code>rnorm()</code>). The arguments to these functions vary and correspond to the parameters appropriate to each family.</p>
<p>It would be tedious and repetitious to consider all of the probability distributions taken up in the text, and I’ll instead confine my illustrations to the binomial and normal families, along with the multivariate-normal family.</p>
<p>For example, let’s draw a slightly simplified version of Figure 5.1 in the text, for the probability mass function of a binomial random variable with probability of success <span class="math inline">\(\phi = .7\)</span> and <span class="math inline">\(n = 10\)</span> binomial trials, where the number of successes <span class="math inline">\(x\)</span> ranges from zero to 10:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="primer-math.html#cb246-1"></a>x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb246-2"><a href="primer-math.html#cb246-2"></a>p &lt;-<span class="st"> </span><span class="kw">dbinom</span>(x, <span class="dt">size=</span><span class="dv">10</span>, <span class="dt">prob=</span><span class="fl">0.7</span>)</span>
<span id="cb246-3"><a href="primer-math.html#cb246-3"></a><span class="kw">cbind</span>(x, p) <span class="co"># table of probabilities</span></span></code></pre></div>
<pre><code>##        x            p
##  [1,]  0 0.0000059049
##  [2,]  1 0.0001377810
##  [3,]  2 0.0014467005
##  [4,]  3 0.0090016920
##  [5,]  4 0.0367569090
##  [6,]  5 0.1029193452
##  [7,]  6 0.2001209490
##  [8,]  7 0.2668279320
##  [9,]  8 0.2334744405
## [10,]  9 0.1210608210
## [11,] 10 0.0282475249</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="primer-math.html#cb248-1"></a><span class="kw">plot</span>(x, p, <span class="dt">ylab=</span><span class="st">&quot;p(x)&quot;</span>, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)</span>
<span id="cb248-2"><a href="primer-math.html#cb248-2"></a><span class="kw">points</span>(x, p, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb248-3"><a href="primer-math.html#cb248-3"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>Here are a table and plot of the cumulative distribution function of the same binomial distribution:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="primer-math.html#cb249-1"></a>P &lt;-<span class="st"> </span><span class="kw">pbinom</span>(x, <span class="dt">size=</span><span class="dv">10</span>, <span class="dt">prob=</span><span class="fl">0.7</span>)</span>
<span id="cb249-2"><a href="primer-math.html#cb249-2"></a><span class="kw">cbind</span>(x, P) <span class="co"># table of cumulative probabilities</span></span></code></pre></div>
<pre><code>##        x            P
##  [1,]  0 0.0000059049
##  [2,]  1 0.0001436859
##  [3,]  2 0.0015903864
##  [4,]  3 0.0105920784
##  [5,]  4 0.0473489874
##  [6,]  5 0.1502683326
##  [7,]  6 0.3503892816
##  [8,]  7 0.6172172136
##  [9,]  8 0.8506916541
## [10,]  9 0.9717524751
## [11,] 10 1.0000000000</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="primer-math.html#cb251-1"></a><span class="kw">plot</span>(x, P, <span class="dt">ylab=</span><span class="st">&quot;P(x)&quot;</span>, <span class="dt">type=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb251-2"><a href="primer-math.html#cb251-2"></a><span class="kw">points</span>(x, P, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb251-3"><a href="primer-math.html#cb251-3"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>The .95 quantile (for example) of the distribution of a discrete random variable <span class="math inline">\(X\)</span> is defined as the smallest value of <span class="math inline">\(x\)</span> of <span class="math inline">\(X\)</span> such that <span class="math inline">\(\mathrm{Pr}(X \leq x) \geq .95\)</span>. For the binomial distribution with <span class="math inline">\(n = 10\)</span> and <span class="math inline">\(\phi = .7\)</span>, the .95 quantile is</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="primer-math.html#cb252-1"></a><span class="kw">qbinom</span>(<span class="fl">0.95</span>, <span class="dt">size=</span><span class="dv">10</span>, <span class="dt">prob=</span><span class="fl">0.7</span>)</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<p>as is readily verified by reference to the cumulative distribution above.</p>
<p>Finally, let’s generate <span class="math inline">\(N = 1000\)</span> random draws from the binomial distribution with <span class="math inline">\(n = 10\)</span> and <span class="math inline">\(\phi = .7\)</span>, and then examine the distribution of the sampled values:</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="primer-math.html#cb254-1"></a><span class="kw">set.seed</span>(<span class="dv">327429734</span>) <span class="co"># for reproducibility</span></span>
<span id="cb254-2"><a href="primer-math.html#cb254-2"></a>X &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1000</span>, <span class="dt">size=</span><span class="dv">10</span>, <span class="dt">prob=</span><span class="fl">0.7</span>)</span>
<span id="cb254-3"><a href="primer-math.html#cb254-3"></a>(counts &lt;-<span class="kw">table</span>(X))</span></code></pre></div>
<pre><code>## X
##   2   3   4   5   6   7   8   9  10 
##   1  10  41 108 197 270 240 108  25</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="primer-math.html#cb256-1"></a><span class="kw">plot</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">as.vector</span>(counts), <span class="dt">type=</span><span class="st">&quot;h&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb256-2"><a href="primer-math.html#cb256-2"></a><span class="kw">points</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>, counts, <span class="dt">pch=</span><span class="dv">16</span>)</span>
<span id="cb256-3"><a href="primer-math.html#cb256-3"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="primer-math.html#cb257-1"></a><span class="kw">mean</span>(X)</span></code></pre></div>
<pre><code>## [1] 6.95</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="primer-math.html#cb259-1"></a><span class="kw">sd</span>(X)</span></code></pre></div>
<pre><code>## [1] 1.442075</code></pre>
<p>The sample mean <span class="math inline">\(\overline{X} = 6.95\)</span> and standard deviation <span class="math inline">\(S = 1.442075\)</span> are close to the binomial expectation <span class="math inline">\(\mu = n\phi = 7\)</span> and <span class="math inline">\(\sigma = \sqrt{n \phi (1 - \phi)} = \sqrt{10 \times .7 \times .3} = 1.449138\)</span>, as one would expect in a sample of size <span class="math inline">\(N = 1000\)</span>. I set the ‘seed’ of R’s pseudo-random number generator to an arbitrary known value so that if you redo my computation, you’ll get exactly the same results, rather than a different sequence of random numbers.</p>
<p>Consider now the normal distribution <span class="math inline">\(X \sim N(10, 9)\)</span>. Let’s plot the density and cumulative distribution functions of <span class="math inline">\(X\)</span> over the range <span class="math inline">\(0 \leq X \leq 20\)</span>:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="primer-math.html#cb261-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dt">length=</span><span class="dv">1000</span>)</span>
<span id="cb261-2"><a href="primer-math.html#cb261-2"></a><span class="kw">plot</span>(x, <span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="dv">10</span>, <span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="dv">9</span>)), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;p(x)&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb261-3"><a href="primer-math.html#cb261-3"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="primer-math.html#cb262-1"></a><span class="kw">plot</span>(x, <span class="kw">pnorm</span>(x, <span class="dt">mean=</span><span class="dv">10</span>, <span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="dv">9</span>)), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;P(x)&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb262-2"><a href="primer-math.html#cb262-2"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>Next, let’s find the .025 and .975 quantiles of <span class="math inline">\(X \sim N(10, 9)\)</span>:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="primer-math.html#cb263-1"></a><span class="kw">qnorm</span>(<span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="dt">mean=</span><span class="dv">10</span>, <span class="dt">sd=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1]  4.120108 15.879892</code></pre>
<p>Finally, let’s draw a sample of <span class="math inline">\(N = 1000\)</span> observations from the distribution, superimposing a nonparametric kernel-density estimate for the sample (produced by the <code>densityPlot()</code> function in the <strong>car</strong> package) over the theoretical (i.e., population) density function, and calculating the mean and standard deviation of the sample:</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="primer-math.html#cb265-1"></a><span class="kw">library</span>(<span class="st">&quot;car&quot;</span>) <span class="co"># for densityPlot()</span></span></code></pre></div>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:mosaicCore&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="primer-math.html#cb269-1"></a><span class="kw">set.seed</span>(<span class="dv">4747834</span>)</span>
<span id="cb269-2"><a href="primer-math.html#cb269-2"></a>X &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>, <span class="dt">mean=</span><span class="dv">10</span>, <span class="dt">sd=</span><span class="dv">3</span>)</span>
<span id="cb269-3"><a href="primer-math.html#cb269-3"></a><span class="kw">densityPlot</span>(X, <span class="dt">method=</span><span class="st">&quot;kernel&quot;</span>, <span class="dt">col=</span><span class="st">&quot;cyan&quot;</span>)</span>
<span id="cb269-4"><a href="primer-math.html#cb269-4"></a><span class="kw">lines</span>(x, <span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="dv">10</span>, <span class="dt">sd=</span><span class="dv">3</span>), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;magenta&quot;</span>)</span>
<span id="cb269-5"><a href="primer-math.html#cb269-5"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">inset=</span><span class="fl">0.05</span>, <span class="dt">lty=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;magenta&quot;</span>), </span>
<span id="cb269-6"><a href="primer-math.html#cb269-6"></a>       <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="st">&quot;population&quot;</span>))</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="primer-math.html#cb270-1"></a><span class="kw">mean</span>(X)</span></code></pre></div>
<pre><code>## [1] 10.0305</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="primer-math.html#cb272-1"></a><span class="kw">sd</span>(X)</span></code></pre></div>
<pre><code>## [1] 2.823638</code></pre>
<p>The short lines at the bottom of the density plot—called a ‘rugplot’ or ‘one-dimensional scatterplot’—show the individual sampled values.</p>
<p>As I mentioned, there are no functions in the standard R distribution for the multivariate-normal distribution, which is, however, supported by the contributed <strong>mvtnorm</strong> package. For example, we can use the function <code>dmvnorm()</code> from this package to draw a picture of the density function, similar to Figure 5.9 in the text, of the bivariate-normal distribution with expectations <span class="math inline">\(\mu_1 = 5, \mu_2 = 6\)</span>, standard deviations <span class="math inline">\(\sigma_1 = 1.5, \sigma_2 = 3\)</span>, and covariance <span class="math inline">\(\sigma_{12} = 2.25\)</span>:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="primer-math.html#cb274-1"></a><span class="kw">library</span>(<span class="st">&quot;mvtnorm&quot;</span>)</span>
<span id="cb274-2"><a href="primer-math.html#cb274-2"></a><span class="kw">library</span>(<span class="st">&quot;lattice&quot;</span>) <span class="co"># for wireframe()</span></span>
<span id="cb274-3"><a href="primer-math.html#cb274-3"></a></span>
<span id="cb274-4"><a href="primer-math.html#cb274-4"></a>mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb274-5"><a href="primer-math.html#cb274-5"></a>Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">1.5</span><span class="op">^</span><span class="dv">2</span>, <span class="fl">2.25</span>, <span class="fl">2.25</span>, <span class="dv">3</span><span class="op">^</span><span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb274-6"><a href="primer-math.html#cb274-6"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dt">length=</span><span class="dv">25</span>)</span>
<span id="cb274-7"><a href="primer-math.html#cb274-7"></a>X &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">x1=</span>x, <span class="dt">x2=</span>x)</span>
<span id="cb274-8"><a href="primer-math.html#cb274-8"></a>X<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">dmvnorm</span>(X, <span class="dt">mean=</span>mu, <span class="dt">sigma=</span>Sigma)</span>
<span id="cb274-9"><a href="primer-math.html#cb274-9"></a><span class="kw">head</span>(X)</span></code></pre></div>
<pre><code>##    x1 x2            p
## 1 0.0  0 0.0001466088
## 2 0.5  0 0.0003840338
## 3 1.0  0 0.0008674391
## 4 1.5  0 0.0016895406
## 5 2.0  0 0.0028376470
## 6 2.5  0 0.0041096816</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="primer-math.html#cb276-1"></a><span class="kw">tail</span>(X)</span></code></pre></div>
<pre><code>##       x1 x2            p
## 620  9.5 12 3.840338e-04
## 621 10.0 12 1.466088e-04
## 622 10.5 12 4.826257e-05
## 623 11.0 12 1.370002e-05
## 624 11.5 12 3.353450e-06
## 625 12.0 12 7.078197e-07</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="primer-math.html#cb278-1"></a><span class="kw">wireframe</span>(p <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data=</span>X, <span class="dt">scales=</span><span class="kw">list</span>(<span class="dt">arrows=</span><span class="ot">FALSE</span>),</span>
<span id="cb278-2"><a href="primer-math.html#cb278-2"></a>          <span class="dt">xlab=</span><span class="kw">expression</span>(x[<span class="dv">1</span>]), <span class="dt">ylab=</span><span class="kw">expression</span>(x[<span class="dv">2</span>]), </span>
<span id="cb278-3"><a href="primer-math.html#cb278-3"></a>          <span class="dt">zlab=</span><span class="kw">list</span>(<span class="dt">label=</span><span class="kw">expression</span>(<span class="kw">p</span>(x[<span class="dv">1</span>], x[<span class="dv">2</span>])), <span class="dt">rot=</span><span class="dv">90</span>))</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>Some explanation of the R code for this graph is in order: 25 values of <code>x1</code> and <code>x2</code> are generated, each ranging from zero to 12. The <code>expand.grid()</code> function forms all <span class="math inline">\(25 \times 25 = 625\)</span> combinations of values of the two variables, placing these in the data frame <code>X</code>. Then <code>dmvnorm()</code> computes the density, assigned to <code>X$p</code>, at each of the 625 points. Finally, the <code>wireframe()</code> function from the standard R <strong>lattice</strong> package <span class="citation">[@Sarkar2008]</span> draws the 3D graph.</p>
<p>Alternatively, we can use the <code>contourplot()</code> function in the <strong>lattice</strong> package to draw some of the elliptical contours of the bivariate-normal distribution, using 100 rather than 25 values for each <span class="math inline">\(x\)</span> to produce a smoother plot:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="primer-math.html#cb279-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dt">length=</span><span class="dv">100</span>)</span>
<span id="cb279-2"><a href="primer-math.html#cb279-2"></a>X &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">x1=</span>x, <span class="dt">x2=</span>x)</span>
<span id="cb279-3"><a href="primer-math.html#cb279-3"></a>X<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">dmvnorm</span>(X, <span class="dt">mean=</span>mu, <span class="dt">sigma=</span>Sigma)</span>
<span id="cb279-4"><a href="primer-math.html#cb279-4"></a><span class="kw">contourplot</span>(p <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2, <span class="dt">data=</span>X, <span class="dt">xlab=</span><span class="kw">expression</span>(x[<span class="dv">1</span>]), <span class="dt">ylab=</span><span class="kw">expression</span>(x[<span class="dv">2</span>]), <span class="dt">lwd=</span><span class="dv">2</span>,</span>
<span id="cb279-5"><a href="primer-math.html#cb279-5"></a>            <span class="dt">panel=</span><span class="cf">function</span>(x, y, ...){</span>
<span id="cb279-6"><a href="primer-math.html#cb279-6"></a>              <span class="kw">panel.contourplot</span>(x, y, ...)</span>
<span id="cb279-7"><a href="primer-math.html#cb279-7"></a>              <span class="kw">panel.abline</span>(<span class="dt">h=</span><span class="dv">6</span>, <span class="dt">v=</span><span class="dv">5</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb279-8"><a href="primer-math.html#cb279-8"></a>              <span class="kw">panel.points</span>(<span class="dt">x=</span><span class="dv">5</span>, <span class="dt">y=</span><span class="dv">6</span>, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb279-9"><a href="primer-math.html#cb279-9"></a>            })</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>Finally, if we wish to show the standard concentration ellipse or an ellipse drawn to enclose a specific probability (as in Figure 5.10 in the text), it’s convenient to use the <code>ellipse()</code> function in the <strong>car</strong> package (which was loaded previously):</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="primer-math.html#cb280-1"></a><span class="kw">ellipse</span>(<span class="dt">center=</span>mu, <span class="dt">shape=</span>Sigma, <span class="dt">radius=</span><span class="kw">sqrt</span>(<span class="kw">qchisq</span>(.<span class="dv">95</span>, <span class="dv">2</span>)), <span class="dt">add=</span><span class="ot">FALSE</span>,</span>
<span id="cb280-2"><a href="primer-math.html#cb280-2"></a>        <span class="dt">xlab=</span><span class="kw">expression</span>(x[<span class="dv">1</span>]), <span class="dt">ylab=</span><span class="kw">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb280-3"><a href="primer-math.html#cb280-3"></a>        <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="ot">TRUE</span>, <span class="dt">asp=</span><span class="dv">1</span>) <span class="co"># 95% concentration ellipse</span></span>
<span id="cb280-4"><a href="primer-math.html#cb280-4"></a><span class="kw">ellipse</span>(<span class="dt">center=</span>mu, <span class="dt">shape=</span>Sigma, <span class="dt">radius=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="ot">TRUE</span>) <span class="co"># standard ellipse</span></span>
<span id="cb280-5"><a href="primer-math.html#cb280-5"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">5</span>, <span class="fl">6.5</span>), <span class="dt">h=</span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>), <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
<p><code>ellipse()</code> takes three required arguments: In the current application, <code>center</code> is the vector of means for <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, <code>shape</code> is their covariance matrix, and <code>radius</code> is the square-root of the value of <span class="math inline">\((\mathbf{x} - \boldsymbol{\mu})^\prime \boldsymbol{\Sigma}^{-1} (\mathbf{x} - \boldsymbol{\mu})\)</span> defining the ellipse—equal to one for the standard data ellipse and to <span class="math inline">\(\sqrt{\chi^2_{2, .95}} = 2.448\)</span> for the 95% concentration ellipse. The horizontal and vertical lines on the graph mark the means of the two variables and <span class="math inline">\(\pm\)</span> one standard deviation around each mean.</p>
</div>
<div id="chapter-6.-an-introduction-to-statistical-theory" class="section level2">
<h2><span class="header-section-number">16.19</span> Chapter 6. An Introduction to Statistical Theory</h2>
</div>
<div id="central-limit-theorem" class="section level2">
<h2><span class="header-section-number">16.20</span> Central Limit Theorem</h2>
<p>Figure 6.3 in the text illustrates the central limit theorem for the sample mean <span class="math inline">\(\overline{X}\)</span> for samples of size <span class="math inline">\(n = 1, 2, 5\)</span>, and <span class="math inline">\(25\)</span> drawn from an exponential population with rate parameter <span class="math inline">\(\lambda = 1\)</span>. As explained in the text, the true sampling distribution of the mean from an exponential population is gamma, and the graph shows both the true sampling distribution and the asymptotic normal approximation. It’s easy to draw a version of this graph using <code>dgamma()</code>, the gamma density function, and <code>dnorm()</code>, the approximating normal density:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="primer-math.html#cb281-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb281-2"><a href="primer-math.html#cb281-2"></a></span>
<span id="cb281-3"><a href="primer-math.html#cb281-3"></a>x&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">6</span>, <span class="dt">length=</span><span class="dv">10000</span>)</span>
<span id="cb281-4"><a href="primer-math.html#cb281-4"></a></span>
<span id="cb281-5"><a href="primer-math.html#cb281-5"></a>n &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb281-6"><a href="primer-math.html#cb281-6"></a>dg &lt;-<span class="st"> </span>n<span class="op">*</span><span class="kw">dgamma</span>(x<span class="op">*</span>n, <span class="dt">shape=</span>n)</span>
<span id="cb281-7"><a href="primer-math.html#cb281-7"></a>dg[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb281-8"><a href="primer-math.html#cb281-8"></a>dn &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dv">1</span>, <span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb281-9"><a href="primer-math.html#cb281-9"></a><span class="kw">plot</span>(<span class="kw">range</span>(x), <span class="kw">range</span>(dn, dg, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb281-10"><a href="primer-math.html#cb281-10"></a>    <span class="dt">xlab=</span><span class="kw">expression</span>(<span class="kw">bar</span>(x)),</span>
<span id="cb281-11"><a href="primer-math.html#cb281-11"></a>    <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">p</span>(<span class="kw">bar</span>(x))), </span>
<span id="cb281-12"><a href="primer-math.html#cb281-12"></a>    <span class="dt">main=</span><span class="st">&quot;(a) n = 1&quot;</span>)</span>
<span id="cb281-13"><a href="primer-math.html#cb281-13"></a><span class="kw">lines</span>(x, dg, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb281-14"><a href="primer-math.html#cb281-14"></a><span class="kw">lines</span>(x, dn, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb281-15"><a href="primer-math.html#cb281-15"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">h=</span><span class="dv">0</span>)</span>
<span id="cb281-16"><a href="primer-math.html#cb281-16"></a></span>
<span id="cb281-17"><a href="primer-math.html#cb281-17"></a>n &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb281-18"><a href="primer-math.html#cb281-18"></a>dg &lt;-<span class="st"> </span>n<span class="op">*</span><span class="kw">dgamma</span>(x<span class="op">*</span>n, <span class="dt">shape=</span>n)</span>
<span id="cb281-19"><a href="primer-math.html#cb281-19"></a>dg[x <span class="op">&lt;</span><span class="st"> </span><span class="fl">.01</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb281-20"><a href="primer-math.html#cb281-20"></a>dn &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dv">1</span>, <span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb281-21"><a href="primer-math.html#cb281-21"></a><span class="kw">plot</span>(<span class="kw">range</span>(x), <span class="kw">range</span>(dn, dg, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb281-22"><a href="primer-math.html#cb281-22"></a>    <span class="dt">xlab=</span><span class="kw">expression</span>(<span class="kw">bar</span>(x)),</span>
<span id="cb281-23"><a href="primer-math.html#cb281-23"></a>    <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">p</span>(<span class="kw">bar</span>(x))),</span>
<span id="cb281-24"><a href="primer-math.html#cb281-24"></a>    <span class="dt">main=</span><span class="st">&quot;(b) n = 2&quot;</span>)</span>
<span id="cb281-25"><a href="primer-math.html#cb281-25"></a><span class="kw">lines</span>(x, dg, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb281-26"><a href="primer-math.html#cb281-26"></a><span class="kw">lines</span>(x, dn, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb281-27"><a href="primer-math.html#cb281-27"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">h=</span><span class="dv">0</span>)</span>
<span id="cb281-28"><a href="primer-math.html#cb281-28"></a></span>
<span id="cb281-29"><a href="primer-math.html#cb281-29"></a>n &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb281-30"><a href="primer-math.html#cb281-30"></a>dg &lt;-<span class="st"> </span>n<span class="op">*</span><span class="kw">dgamma</span>(x<span class="op">*</span>n, <span class="dt">shape=</span>n)</span>
<span id="cb281-31"><a href="primer-math.html#cb281-31"></a>dg[x <span class="op">&lt;</span><span class="st"> </span><span class="fl">.01</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb281-32"><a href="primer-math.html#cb281-32"></a>dn &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dv">1</span>, <span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb281-33"><a href="primer-math.html#cb281-33"></a><span class="kw">plot</span>(<span class="kw">range</span>(x), <span class="kw">range</span>(dn, dg, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb281-34"><a href="primer-math.html#cb281-34"></a>    <span class="dt">xlab=</span><span class="kw">expression</span>(<span class="kw">bar</span>(x)),</span>
<span id="cb281-35"><a href="primer-math.html#cb281-35"></a>    <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">p</span>(<span class="kw">bar</span>(x))),</span>
<span id="cb281-36"><a href="primer-math.html#cb281-36"></a>    <span class="dt">main=</span><span class="st">&quot;(d) n = 5&quot;</span>)</span>
<span id="cb281-37"><a href="primer-math.html#cb281-37"></a><span class="kw">lines</span>(x, dg, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb281-38"><a href="primer-math.html#cb281-38"></a><span class="kw">lines</span>(x, dn, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb281-39"><a href="primer-math.html#cb281-39"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">h=</span><span class="dv">0</span>)</span>
<span id="cb281-40"><a href="primer-math.html#cb281-40"></a></span>
<span id="cb281-41"><a href="primer-math.html#cb281-41"></a>n &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb281-42"><a href="primer-math.html#cb281-42"></a>dg &lt;-<span class="st"> </span>n<span class="op">*</span><span class="kw">dgamma</span>(x<span class="op">*</span>n, <span class="dt">shape=</span>n)</span>
<span id="cb281-43"><a href="primer-math.html#cb281-43"></a>dg[x <span class="op">&lt;</span><span class="st"> </span><span class="fl">.01</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb281-44"><a href="primer-math.html#cb281-44"></a>dn &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dv">1</span>, <span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb281-45"><a href="primer-math.html#cb281-45"></a><span class="kw">plot</span>(<span class="kw">range</span>(x), <span class="kw">range</span>(dn, dg, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="dt">type=</span><span class="st">&quot;n&quot;</span>,</span>
<span id="cb281-46"><a href="primer-math.html#cb281-46"></a>    <span class="dt">xlab=</span><span class="kw">expression</span>(<span class="kw">bar</span>(x)),</span>
<span id="cb281-47"><a href="primer-math.html#cb281-47"></a>    <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">p</span>(<span class="kw">bar</span>(x))),</span>
<span id="cb281-48"><a href="primer-math.html#cb281-48"></a>    <span class="dt">main=</span><span class="st">&quot;(d) n = 25&quot;</span>)</span>
<span id="cb281-49"><a href="primer-math.html#cb281-49"></a><span class="kw">lines</span>(x, dg, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb281-50"><a href="primer-math.html#cb281-50"></a><span class="kw">lines</span>(x, dn, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">25</span>)</span>
<span id="cb281-51"><a href="primer-math.html#cb281-51"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">h=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
</div>
<div id="robust-estimation" class="section level2">
<h2><span class="header-section-number">16.21</span> Robust Estimation</h2>
<p>The example in the text uses six observations sampled from the standard normal distribution and a seventh outlying value of 10:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="primer-math.html#cb282-1"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.068</span>, <span class="fl">-1.282</span>, <span class="fl">0.013</span>, <span class="fl">0.141</span>, <span class="fl">-0.980</span>, <span class="fl">1.263</span>, <span class="dv">10</span>) </span></code></pre></div>
<p>Here’s a dot chart of the data, produced by the <code>Dotplot()</code> function in the <strong>RcmdrMisc</strong> package, along with the mean and median of the seven values:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="primer-math.html#cb283-1"></a><span class="kw">library</span>(<span class="st">&quot;RcmdrMisc&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: package &#39;RcmdrMisc&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Warning: package &#39;sandwich&#39; was built under R version 4.0.3</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="primer-math.html#cb287-1"></a><span class="kw">Dotplot</span>(x)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="primer-math.html#cb288-1"></a><span class="kw">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] 1.298143</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="primer-math.html#cb290-1"></a><span class="kw">median</span>(x)</span></code></pre></div>
<pre><code>## [1] 0.013</code></pre>
<p>It wouldn’t be difficult to program the M-estimator of location described in the text, but it’s simpler just to use the <code>rlm()</code> (robust linear model) function in the <strong>MASS</strong> package, which is part of the standard R distribution (and which was loaded earlier in this document), fitting a linear model with just a constant:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="primer-math.html#cb292-1"></a><span class="kw">rlm</span>(x <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">k=</span><span class="fl">1.345</span>, <span class="dt">psi=</span>psi.huber)</span></code></pre></div>
<pre><code>## Call:
## rlm(formula = x ~ 1, k = 1.345, psi = psi.huber)
## Converged in 7 iterations
## 
## Coefficients:
## (Intercept) 
##   0.2009213 
## 
## Degrees of freedom: 7 total; 6 residual
## Scale estimate: 1.58</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="primer-math.html#cb294-1"></a><span class="kw">rlm</span>(x <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">c=</span><span class="fl">4.685</span>, <span class="dt">psi=</span>psi.bisquare)</span></code></pre></div>
<pre><code>## Call:
## rlm(formula = x ~ 1, c = 4.685, psi = psi.bisquare)
## Converged in 5 iterations
## 
## Coefficients:
## (Intercept) 
##  -0.1615681 
## 
## Degrees of freedom: 7 total; 6 residual
## Scale estimate: 1.21</code></pre>
<p>The <code>k</code> argument in the first call to <code>rlm()</code> and the <code>c</code> argument in the second call are the tuning constants for the Huber and bisquare (biweight) estimators that were used in the text. These are also the default tuning constants employed by <code>rlm()</code>—I show them explicitly here for concreteness. The “scale estimate” in the output is the rescaled median absolute deviation of the residuals from the M-estimator, <span class="math inline">\(S = \mathrm{MAD}/0.6745\)</span>, also described in the text.</p>
</div>
<div id="maximum-likelihood-estimation" class="section level2">
<h2><span class="header-section-number">16.22</span> Maximum-Likelihood Estimation</h2>
<p>The example in the text is for the Bernoulli log-likelihood function <span class="math inline">\(\log_e L(\phi) = x \log_e \phi + (n - x) \log_e(1 - \phi)\)</span>. The derivative of this function, which was required to maximize the likelihood, is</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="primer-math.html#cb296-1"></a><span class="kw">remove</span>(<span class="st">&quot;x&quot;</span>) <span class="co"># residue of the preceding example</span></span>
<span id="cb296-2"><a href="primer-math.html#cb296-2"></a><span class="kw">D</span>(x<span class="op">*</span><span class="kw">log</span>(phi) <span class="op">+</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>x)<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>phi) <span class="op">~</span><span class="st"> </span>phi)</span></code></pre></div>
<pre><code>## function (phi, n = 25, x) 
## x * (1/phi) - (n - x) * (1/(1 - phi))</code></pre>
<p>which, sans simplification, is the result given in the text.</p>
<p>The second derivative of the log-likelihood is required to compute the information:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="primer-math.html#cb298-1"></a><span class="kw">D</span>(x<span class="op">*</span><span class="kw">log</span>(phi) <span class="op">+</span><span class="st"> </span>(n <span class="op">-</span><span class="st"> </span>x)<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>phi) <span class="op">~</span><span class="st"> </span>phi <span class="op">+</span><span class="st"> </span>phi)</span></code></pre></div>
<pre><code>## function (phi, n = 25, x) 
## -(x * (1/phi^2) + (n - x) * (1/(1 - phi)^2))</code></pre>
<p>The log-likelihood for the normal distribution given in the text is
<span class="math display">\[
\log_e L(\mu, \sigma^2) = -\frac{n}{2}\log_e 2\pi - \frac{n}{2}\log_e \sigma^2 - \frac{1}{2\sigma^2} \sum (X_i - \mu)^2
\]</span></p>
<p>To find the partial derivatives of this log-likelihood with respect to the parameters using <code>D()</code>, I’ll initially ignore the sum—I can then use the rule that the derivative of a sum of terms is the sum of the derivatives of the terms to reinsert the summation in the result; I’ll also not bother with the first term, <span class="math inline">\(-\frac{n}{2}\log_e 2\pi\)</span>, which doesn’t involve the parameters <span class="math inline">\(\sigma^2\)</span> and <span class="math inline">\(\mu\)</span>:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="primer-math.html#cb300-1"></a><span class="kw">remove</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;mu&quot;</span>) <span class="co"># residue of a previous example</span></span>
<span id="cb300-2"><a href="primer-math.html#cb300-2"></a><span class="kw">D</span>(<span class="op">-</span>(n<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(sigma2) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma2))<span class="op">*</span>(X <span class="op">-</span><span class="st"> </span>mu)<span class="op">^</span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>mu)</span></code></pre></div>
<pre><code>## function (mu, n = 25, sigma2, X) 
## (1/(2 * sigma2)) * (2 * (X - mu))</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="primer-math.html#cb302-1"></a><span class="kw">D</span>(<span class="op">-</span>(n<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(sigma2) <span class="op">-</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma2))<span class="op">*</span>(X <span class="op">-</span><span class="st"> </span>mu)<span class="op">^</span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>sigma2)</span></code></pre></div>
<pre><code>## function (sigma2, n = 25, X, mu) 
## -((n/2) * (1/sigma2) - 2/(2 * sigma2)^2 * (X - mu)^2)</code></pre>
<p>Simplifying, taking account of the summation, and noting that the parameter <span class="math inline">\(\sigma^2\)</span> is represented as the R variable <code>sigma2</code>, this result is equivalent to the one given in the text.</p>
</div>
<div id="the-delta-method" class="section level2">
<h2><span class="header-section-number">16.23</span> The Delta Method</h2>
<p>The delta method example in the text is for the logit transformation of the probability <span class="math inline">\(\phi\)</span>: <span class="math inline">\(\Lambda = f(\phi) = \log_e \frac{\phi}{1 - \phi}\)</span>. We therefore need the derivative of <span class="math inline">\(f(\phi)\)</span>:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="primer-math.html#cb304-1"></a><span class="kw">D</span>(<span class="kw">log</span>(phi<span class="op">/</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>phi)) <span class="op">~</span><span class="st"> </span>phi)</span></code></pre></div>
<pre><code>## function (phi) 
## (1/(1 - phi) + phi/(1 - phi)^2)/(phi/(1 - phi))</code></pre>
<p>After (considerable) simplification, this is equivalent to the result given in the text, <span class="math inline">\(f^\prime(\phi) = \frac{1}{\phi(1 - \phi)}\)</span>.</p>
</div>
<div id="bayesian-inference" class="section level2">
<h2><span class="header-section-number">16.24</span> Bayesian Inference</h2>
<p>The simple coin-flipping example of Bayesian inference given in the text uses the conjugate beta prior to the Bernoulli likelihood. Specifically, <span class="math inline">\(h = 7\)</span> heads are observed in <span class="math inline">\(n = 10\)</span> flips of the coin, and I contrast the flat prior Beta(1,1) with the informative prior Beta(16, 16). The resulting Beta(8, 4) and Beta(23, 19) posterior distributions are summarized in Figure 6.13, a version of which is produced by the following R code:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="primer-math.html#cb306-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length=</span><span class="dv">1000</span>)</span>
<span id="cb306-2"><a href="primer-math.html#cb306-2"></a>d1 &lt;-<span class="st"> </span><span class="kw">dbeta</span>(x, <span class="dv">8</span>, <span class="dv">4</span>)</span>
<span id="cb306-3"><a href="primer-math.html#cb306-3"></a>d2 &lt;-<span class="st"> </span><span class="kw">dbeta</span>(x, <span class="dv">23</span>, <span class="dv">19</span>)</span>
<span id="cb306-4"><a href="primer-math.html#cb306-4"></a><span class="kw">plot</span>(<span class="kw">rep</span>(x,<span class="dv">2</span>), <span class="kw">c</span>(d1, d2), <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, </span>
<span id="cb306-5"><a href="primer-math.html#cb306-5"></a>     <span class="dt">xlab=</span><span class="kw">expression</span>(phi), <span class="dt">ylab=</span><span class="kw">expression</span>(<span class="kw">p</span>(phi)))</span>
<span id="cb306-6"><a href="primer-math.html#cb306-6"></a><span class="kw">lines</span>(x, d1, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb306-7"><a href="primer-math.html#cb306-7"></a><span class="kw">lines</span>(x, d2, <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb306-8"><a href="primer-math.html#cb306-8"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">lty=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">legend=</span><span class="kw">c</span>(</span>
<span id="cb306-9"><a href="primer-math.html#cb306-9"></a>  <span class="st">&quot;a = 1, b = 1&quot;</span>,</span>
<span id="cb306-10"><a href="primer-math.html#cb306-10"></a>  <span class="st">&quot;a = 16, b = 16&quot;</span>), </span>
<span id="cb306-11"><a href="primer-math.html#cb306-11"></a>  <span class="dt">title=</span><span class="st">&quot;Posterior for Beta(a, b) Prior&quot;</span>, <span class="dt">inset=</span><span class="fl">0.02</span>)</span>
<span id="cb306-12"><a href="primer-math.html#cb306-12"></a><span class="kw">lines</span>(<span class="kw">c</span>(<span class="kw">qbeta</span>(.<span class="dv">025</span>, <span class="dv">8</span>, <span class="dv">4</span>), <span class="kw">qbeta</span>(.<span class="dv">975</span>, <span class="dv">8</span>, <span class="dv">4</span>)), <span class="kw">rep</span>(<span class="fl">0.2</span>, <span class="dv">2</span>), <span class="dt">lwd=</span><span class="dv">3</span>)</span>
<span id="cb306-13"><a href="primer-math.html#cb306-13"></a><span class="kw">lines</span>(<span class="kw">c</span>(<span class="kw">qbeta</span>(.<span class="dv">025</span>, <span class="dv">23</span>, <span class="dv">19</span>), <span class="kw">qbeta</span>(.<span class="dv">975</span>, <span class="dv">23</span>, <span class="dv">19</span>)), <span class="kw">rep</span>(<span class="fl">0.3</span>, <span class="dv">2</span>), <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb306-14"><a href="primer-math.html#cb306-14"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>)</span>
<span id="cb306-15"><a href="primer-math.html#cb306-15"></a><span class="kw">lines</span>(<span class="kw">rep</span>(x[<span class="kw">which.max</span>(d1)], <span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(d1)), <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb306-16"><a href="primer-math.html#cb306-16"></a><span class="kw">lines</span>(<span class="kw">rep</span>(x[<span class="kw">which.max</span>(d2)], <span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(d2)), <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<p>The beta density function<code>dbeta()</code> is used to graph the posterior densities, and the beta quantile function <code>qbeta()</code> is used to compute the 95% central interval for each posterior distribution.</p>
</div>
<div id="the-metropolis-algorithm" class="section level2">
<h2><span class="header-section-number">16.25</span> The Metropolis Algorithm</h2>
<p>The example given in the text uses the Metroplis algorithm to sample from the bivariate-normal distribution with mean vector and covariance matrix
<span class="math display">\[\begin{eqnarray}
\boldsymbol{\mu} &amp;=&amp;
    \begin{pmatrix} 
        1 \\ 
        2 
    \end{pmatrix}  \\
\boldsymbol{\Sigma} &amp;=&amp; 
    \begin{pmatrix}
    1 &amp; 1 \\
    1 &amp; 4 
    \end{pmatrix} \nonumber
\end{eqnarray}\]</span></p>
<p>The following function <code>p.star()</code> gives bivariate-normal densities up to a constant of proportionality, which I confirm by checking against the <code>dmvnorm()</code> function in the <strong>mvtnorm</strong> package (which was loaded earlier in this document):</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="primer-math.html#cb307-1"></a>p.star &lt;-<span class="st"> </span><span class="cf">function</span>(x, mu, Sigma){</span>
<span id="cb307-2"><a href="primer-math.html#cb307-2"></a>    <span class="kw">exp</span>(<span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>(x <span class="op">-</span><span class="st"> </span>mu) <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(Sigma) <span class="op">%*%</span><span class="st"> </span>(x <span class="op">-</span><span class="st"> </span>mu))</span>
<span id="cb307-3"><a href="primer-math.html#cb307-3"></a>}</span>
<span id="cb307-4"><a href="primer-math.html#cb307-4"></a></span>
<span id="cb307-5"><a href="primer-math.html#cb307-5"></a>mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb307-6"><a href="primer-math.html#cb307-6"></a>(Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">4</span>), <span class="dv">2</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    1
## [2,]    1    4</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="primer-math.html#cb309-1"></a><span class="co"># check</span></span>
<span id="cb309-2"><a href="primer-math.html#cb309-2"></a>some.xs &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb309-3"><a href="primer-math.html#cb309-3"></a><span class="kw">sapply</span>(some.xs, p.star, <span class="dt">mu=</span>mu, <span class="dt">Sigma=</span>Sigma) <span class="op">/</span><span class="st"> </span></span>
<span id="cb309-4"><a href="primer-math.html#cb309-4"></a><span class="st">    </span><span class="kw">sapply</span>(some.xs, dmvnorm, <span class="dt">mean=</span>mu, <span class="dt">sigma=</span>Sigma)</span></code></pre></div>
<pre><code>## [1] 10.8828 10.8828 10.8828</code></pre>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="primer-math.html#cb311-1"></a><span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">3</span>)  <span class="co"># check normalizing constant</span></span></code></pre></div>
<pre><code>## [1] 10.8828</code></pre>
<p>The code below straightforwardly implements the Metropolis algorithm, exactly as described in the text, to draw <span class="math inline">\(m = 10^5\)</span> values of <span class="math inline">\(\mathbf{x}\)</span>, starting at <span class="math inline">\(\mathbf{x}_0 = (0, 0)^\prime\)</span>, and using a rectangular (i.e., bivariate-uniform) proposal distribution implemented as <code>rbvunif()</code>; I employ the standard R <code>system.time()</code> function to time the computation (in seconds):</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="primer-math.html#cb313-1"></a>m &lt;-<span class="st"> </span><span class="fl">1e5</span>  <span class="co"># draws</span></span>
<span id="cb313-2"><a href="primer-math.html#cb313-2"></a>x.current &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)  <span class="co"># x_0</span></span>
<span id="cb313-3"><a href="primer-math.html#cb313-3"></a>xs &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)  <span class="co"># to hold sampled values</span></span>
<span id="cb313-4"><a href="primer-math.html#cb313-4"></a></span>
<span id="cb313-5"><a href="primer-math.html#cb313-5"></a><span class="kw">set.seed</span>(<span class="dv">811018</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb313-6"><a href="primer-math.html#cb313-6"></a></span>
<span id="cb313-7"><a href="primer-math.html#cb313-7"></a>delta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)  <span class="co"># for bivariate uniform proposal distribution</span></span>
<span id="cb313-8"><a href="primer-math.html#cb313-8"></a></span>
<span id="cb313-9"><a href="primer-math.html#cb313-9"></a>rbvunif &lt;-<span class="st"> </span><span class="cf">function</span>(mu, delta){</span>
<span id="cb313-10"><a href="primer-math.html#cb313-10"></a>    u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>, mu[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>delta[<span class="dv">1</span>], mu[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>delta[<span class="dv">1</span>])</span>
<span id="cb313-11"><a href="primer-math.html#cb313-11"></a>    u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>, mu[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>delta[<span class="dv">2</span>], mu[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>delta[<span class="dv">2</span>])</span>
<span id="cb313-12"><a href="primer-math.html#cb313-12"></a>    <span class="kw">c</span>(u1, u2)</span>
<span id="cb313-13"><a href="primer-math.html#cb313-13"></a>}</span>
<span id="cb313-14"><a href="primer-math.html#cb313-14"></a></span>
<span id="cb313-15"><a href="primer-math.html#cb313-15"></a>accepted &lt;-<span class="st"> </span>rejected &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb313-16"><a href="primer-math.html#cb313-16"></a></span>
<span id="cb313-17"><a href="primer-math.html#cb313-17"></a><span class="kw">system.time</span>(</span>
<span id="cb313-18"><a href="primer-math.html#cb313-18"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb313-19"><a href="primer-math.html#cb313-19"></a>        x.proposed &lt;-<span class="st"> </span><span class="kw">rbvunif</span>(<span class="dt">mu=</span>x.current, <span class="dt">delta=</span>delta)  <span class="co"># proposal</span></span>
<span id="cb313-20"><a href="primer-math.html#cb313-20"></a>        a &lt;-<span class="st"> </span><span class="kw">p.star</span>(x.proposed, mu, Sigma) <span class="op">/</span></span>
<span id="cb313-21"><a href="primer-math.html#cb313-21"></a><span class="st">            </span><span class="kw">p.star</span>(x.current, mu, Sigma)  <span class="co"># acceptance ratio</span></span>
<span id="cb313-22"><a href="primer-math.html#cb313-22"></a>        <span class="cf">if</span> (a <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">||</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) <span class="op">&lt;=</span><span class="st"> </span>a) {</span>
<span id="cb313-23"><a href="primer-math.html#cb313-23"></a>            xs[i, ] &lt;-<span class="st"> </span>x.proposed</span>
<span id="cb313-24"><a href="primer-math.html#cb313-24"></a>            x.current &lt;-<span class="st"> </span>x.proposed</span>
<span id="cb313-25"><a href="primer-math.html#cb313-25"></a>            accepted &lt;-<span class="st"> </span>accepted <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb313-26"><a href="primer-math.html#cb313-26"></a>        }</span>
<span id="cb313-27"><a href="primer-math.html#cb313-27"></a>        <span class="cf">else</span> {</span>
<span id="cb313-28"><a href="primer-math.html#cb313-28"></a>            xs[i, ] &lt;-<span class="st"> </span>x.current</span>
<span id="cb313-29"><a href="primer-math.html#cb313-29"></a>            rejected &lt;-<span class="st"> </span>rejected <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb313-30"><a href="primer-math.html#cb313-30"></a>        }</span>
<span id="cb313-31"><a href="primer-math.html#cb313-31"></a>    }</span>
<span id="cb313-32"><a href="primer-math.html#cb313-32"></a>)</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   12.80    0.12   13.76</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="primer-math.html#cb315-1"></a>accepted<span class="op">/</span>m</span></code></pre></div>
<pre><code>## [1] 0.41678</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="primer-math.html#cb317-1"></a>accepted <span class="op">+</span><span class="st"> </span>rejected</span></code></pre></div>
<pre><code>## [1] 1e+05</code></pre>
<p>The seed used for R’s random-number generator and the R code is the same as employed for the example in the text, and consequently I get identical results. Here, for example are the sample mean vector and covariance matrix:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="primer-math.html#cb319-1"></a><span class="kw">colMeans</span>(xs)</span></code></pre></div>
<pre><code>## [1] 1.002813 1.986911</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="primer-math.html#cb321-1"></a><span class="kw">cov</span>(xs)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.9891840 0.9721024
## [2,] 0.9721024 3.9627934</code></pre>
<p>Here are the autocorrelation functions for the sampled values, similar to Figure 6.16 in the text:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="primer-math.html#cb323-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb323-2"><a href="primer-math.html#cb323-2"></a><span class="kw">acf</span>(xs[, <span class="dv">1</span>])</span>
<span id="cb323-3"><a href="primer-math.html#cb323-3"></a><span class="kw">acf</span>(xs[, <span class="dv">2</span>])</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>And here’s some R code that (when run interactively outside of this <code>.Rmd</code> document—only the final result is shown here) produces an animation, similar to Figure 6.14 in the text but of the first 300 sampled points, with successive points connected by line-segments. The theoretical 95% concentration ellipse for the bivariate-normal distribution is superimposed on the graph; the magenta points represent rejected proposals (and hence repeated successive values), while the black points represent accepted proposals:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="primer-math.html#cb324-1"></a><span class="kw">eqscplot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">8</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">8</span>),</span>
<span id="cb324-2"><a href="primer-math.html#cb324-2"></a>         <span class="dt">xlab=</span><span class="kw">expression</span>(x[<span class="dv">1</span>]), <span class="dt">ylab=</span><span class="kw">expression</span>(x[<span class="dv">2</span>]))</span>
<span id="cb324-3"><a href="primer-math.html#cb324-3"></a><span class="kw">ellipse</span>(mu, Sigma, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">radius=</span><span class="kw">sqrt</span>(<span class="kw">qchisq</span>(.<span class="dv">95</span>, <span class="dv">2</span>)), <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb324-4"><a href="primer-math.html#cb324-4"></a></span>
<span id="cb324-5"><a href="primer-math.html#cb324-5"></a>m &lt;-<span class="st"> </span><span class="dv">300</span></span>
<span id="cb324-6"><a href="primer-math.html#cb324-6"></a>pb &lt;-<span class="st"> </span><span class="kw">txtProgressBar</span>(<span class="dv">1</span>, m, <span class="dt">initial=</span><span class="dv">1</span>, <span class="dt">style=</span><span class="dv">3</span>)</span>
<span id="cb324-7"><a href="primer-math.html#cb324-7"></a><span class="kw">points</span>(xs[<span class="dv">1</span>, <span class="dv">1</span>], xs[<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb324-8"><a href="primer-math.html#cb324-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m){</span>
<span id="cb324-9"><a href="primer-math.html#cb324-9"></a>    <span class="kw">Sys.sleep</span>(<span class="fl">0.1</span>)</span>
<span id="cb324-10"><a href="primer-math.html#cb324-10"></a>    <span class="kw">setTxtProgressBar</span>(pb, i)</span>
<span id="cb324-11"><a href="primer-math.html#cb324-11"></a>    <span class="kw">lines</span>(xs[<span class="kw">c</span>(i, i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>), ], <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)</span>
<span id="cb324-12"><a href="primer-math.html#cb324-12"></a>    <span class="kw">points</span>(xs[i, <span class="dv">1</span>], xs[i, <span class="dv">2</span>],</span>
<span id="cb324-13"><a href="primer-math.html#cb324-13"></a>           <span class="dt">col =</span> <span class="cf">if</span>(<span class="kw">all</span>(xs[i, ] <span class="op">==</span><span class="st"> </span>xs[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,])) <span class="st">&quot;magenta&quot;</span> <span class="cf">else</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb324-14"><a href="primer-math.html#cb324-14"></a>}</span>
<span id="cb324-15"><a href="primer-math.html#cb324-15"></a><span class="kw">close</span>(pb)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
</div>
<div id="chapter-7.-putting-the-math-to-work-linear-least-squares-regression" class="section level2">
<h2><span class="header-section-number">16.26</span> Chapter 7. Putting the Math to Work: Linear Least-Squares Regression</h2>
<p>Chapter 7 in the text, which focuses on the math of linear least-squares regression, doesn’t have numeric examples until near the end of the chapter, where artificial data are generated to illustrate the elliptical geometry of simple and multiple regression. I’ll also use the artificial multiple-regression data set here more generally to illustrate other aspects of least-squares computations:</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="primer-math.html#cb325-1"></a><span class="kw">set.seed</span>(<span class="dv">54321</span>) <span class="co"># for reprodibility</span></span>
<span id="cb325-2"><a href="primer-math.html#cb325-2"></a>mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb325-3"><a href="primer-math.html#cb325-3"></a>Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">1.5</span><span class="op">^</span><span class="dv">2</span>, <span class="fl">2.25</span>, <span class="fl">2.25</span>, <span class="dv">3</span><span class="op">^</span><span class="dv">2</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb325-4"><a href="primer-math.html#cb325-4"></a>X &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(<span class="dv">100</span>, mu, Sigma)</span>
<span id="cb325-5"><a href="primer-math.html#cb325-5"></a>Data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(X)</span>
<span id="cb325-6"><a href="primer-math.html#cb325-6"></a>X &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span>, X)</span>
<span id="cb325-7"><a href="primer-math.html#cb325-7"></a><span class="kw">names</span>(X) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;constant&quot;</span>, <span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X2&quot;</span>)</span>
<span id="cb325-8"><a href="primer-math.html#cb325-8"></a>eps &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb325-9"><a href="primer-math.html#cb325-9"></a>Beta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="fl">1.5</span>, <span class="dv">2</span>)</span>
<span id="cb325-10"><a href="primer-math.html#cb325-10"></a>y &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>Beta <span class="op">+</span><span class="st"> </span>eps</span>
<span id="cb325-11"><a href="primer-math.html#cb325-11"></a>Data<span class="op">$</span>y &lt;-<span class="st"> </span>y</span>
<span id="cb325-12"><a href="primer-math.html#cb325-12"></a><span class="kw">summary</span>(model &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2, <span class="dt">data=</span>Data))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ X1 + X2, data = Data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.2134  -3.8693   0.2249   3.5513  13.5313 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   4.2571     1.8497   2.301  0.02350 *  
## X1            1.3582     0.4661   2.914  0.00443 ** 
## X2            1.9051     0.2399   7.942 3.57e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.481 on 97 degrees of freedom
## Multiple R-squared:  0.6261,	Adjusted R-squared:  0.6184 
## F-statistic: 81.22 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>As usual, I set the seed for R’s random-number generator to a known value (the same as used to generate the data in the text) so that my results will be reproducible. The <span class="math inline">\(n = 100\)</span> pairs of <span class="math inline">\(x\)</span>-values are sampled using the <code>rmvnorm()</code> function in the <strong>mvtnorm</strong> package (loaded earlier in this document) from the bivariate-normal distribution with mean vector <span class="math inline">\(\boldsymbol{\mu} = (5, 6)^\prime\)</span> and covariance matrix
<span class="math display">\[
\boldsymbol{\Sigma} = 
\begin{pmatrix}
1.5^2 &amp; 2.25 \\
2.25  &amp; 3^2
\end{pmatrix}
\]</span>
producing the model matrix <span class="math inline">\(\mathbf{X}\)</span>, which has an initial column of ones for the regression constant. The <span class="math inline">\(y\)</span>-values are then computed as <span class="math inline">\(\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\varepsilon}\)</span>, where the the population regression coefficients <span class="math inline">\(\boldsymbol{\beta} = (3, 1.5, 2)^\prime\)</span> and the elements of the error vector <span class="math inline">\(\boldsymbol{\varepsilon}\)</span> are independently sampled from the normal distribution <span class="math inline">\(\varepsilon_i = N(0, \sigma^2 = 5^2)\)</span>. I use the standard R <code>lm()</code> function to fit the regression of <span class="math inline">\(y\)</span> on the the two <span class="math inline">\(x\)</span>s to provide comparisons for the results given below. The least-squares regression coefficients and the residual standard deviation (labelled “residual standard error”) are similar to the corresponding population parameters.</p>
</div>
<div id="computing-the-least-squares-regression-coefficients" class="section level2">
<h2><span class="header-section-number">16.27</span> Computing the Least-Squares Regression Coefficients</h2>
<p>I’ll illustrate three approaches, discussed in the text, for computing the least-squares regression coefficients: solving the normal equations directly; using the QR decomposition of the model matrix; and using the SVD decomposition of the model matrix.</p>
<p>The naive solution of the normal equations is obtained by inverting the sum-of-squares-and product matrix, <span class="math inline">\(\mathbf{X}^\prime \mathbf{X}\)</span>:</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="primer-math.html#cb327-1"></a>(b &lt;-<span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>y)</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 4.257054
## [2,] 1.358192
## [3,] 1.905120</code></pre>
<p>In this case, as in most (but not all) cases, the naive approach produces numerically accurate results.</p>
<p>I use the <code>QR()</code> function in the <strong>matlib</strong> package (loaded earlier) to perform the same regression by the QR decomposition of <span class="math inline">\(\mathbf{X}\)</span>:</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="primer-math.html#cb329-1"></a>qr.x &lt;-<span class="st"> </span><span class="kw">QR</span>(X)</span>
<span id="cb329-2"><a href="primer-math.html#cb329-2"></a>qr.x<span class="op">$</span>rank</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="primer-math.html#cb331-1"></a>qr.x<span class="op">$</span>R</span></code></pre></div>
<pre><code>##      [,1]      [,2]      [,3]
## [1,]  -10 -48.14241 -62.96266
## [2,]    0 -14.97237 -18.00762
## [3,]    0   0.00000 -22.84881</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="primer-math.html#cb333-1"></a><span class="kw">solve</span>(qr.x<span class="op">$</span>R)</span></code></pre></div>
<pre><code>##      [,1]        [,2]        [,3]
## [1,] -0.1  0.32154163  0.02214854
## [2,]  0.0 -0.06678968  0.05263832
## [3,]  0.0  0.00000000 -0.04376595</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="primer-math.html#cb335-1"></a><span class="kw">head</span>(qr.x<span class="op">$</span>Q)</span></code></pre></div>
<pre><code>##      [,1]        [,2]        [,3]
## [1,] -0.1  0.03638222  0.10836692
## [2,] -0.1  0.11819515  0.15100188
## [3,] -0.1  0.06370971  0.11366397
## [4,] -0.1  0.06015792 -0.32169582
## [5,] -0.1 -0.14987967  0.07632433
## [6,] -0.1  0.03468586 -0.15614375</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="primer-math.html#cb337-1"></a><span class="kw">dim</span>(qr.x<span class="op">$</span>Q)</span></code></pre></div>
<pre><code>## [1] 100   3</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="primer-math.html#cb339-1"></a><span class="kw">zapsmall</span>(<span class="kw">t</span>(qr.x<span class="op">$</span>Q) <span class="op">%*%</span><span class="st"> </span>qr.x<span class="op">$</span>Q)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="primer-math.html#cb341-1"></a><span class="kw">solve</span>(qr.x<span class="op">$</span>R) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(qr.x<span class="op">$</span>Q) <span class="op">%*%</span><span class="st"> </span>y</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 4.257054
## [2,] 1.358192
## [3,] 1.905120</code></pre>
<p>As shown, the model matrix is of full column rank (three) and so the the <span class="math inline">\(\mathbf{R}\)</span> matrix is triangular with nonzero diagonal elements, making it easy to invert. The <span class="math inline">\(\mathbf{Q}\)</span> matrix is <span class="math inline">\((100 \times 3)\)</span> with orthonormal columns. The least-squares coefficients are computed in the last line as <span class="math inline">\(\mathbf{b} = \mathbf{R}^{-1} \mathbf{Q}^\prime \mathbf{y}\)</span>.</p>
<p>The following computation of the least-squares coefficients via the SVD decomposition of the model matrix uses the <code>SVD()</code> function in the <strong>matlib</strong> package:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="primer-math.html#cb343-1"></a>svd.x &lt;-<span class="st"> </span><span class="kw">SVD</span>(X)</span>
<span id="cb343-2"><a href="primer-math.html#cb343-2"></a>(Lambda &lt;-<span class="st"> </span><span class="kw">diag</span>(svd.x<span class="op">$</span>d))</span></code></pre></div>
<pre><code>##          [,1]     [,2]     [,3]
## [1,] 85.17186  0.00000 0.000000
## [2,]  0.00000 13.77516 0.000000
## [3,]  0.00000  0.00000 2.915825</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="primer-math.html#cb345-1"></a><span class="kw">solve</span>(Lambda)</span></code></pre></div>
<pre><code>##            [,1]       [,2]      [,3]
## [1,] 0.01174097 0.00000000 0.0000000
## [2,] 0.00000000 0.07259444 0.0000000
## [3,] 0.00000000 0.00000000 0.3429561</code></pre>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="primer-math.html#cb347-1"></a>(Cs &lt;-<span class="st"> </span>svd.x<span class="op">$</span>V)</span></code></pre></div>
<pre><code>##           [,1]       [,2]         [,3]
## [1,] 0.1100548  0.1435885  0.983498999
## [2,] 0.5777432  0.7959300 -0.180854090
## [3,] 0.8087649 -0.5881138 -0.004638678</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="primer-math.html#cb349-1"></a><span class="kw">zapsmall</span>(<span class="kw">t</span>(Cs) <span class="op">%*%</span><span class="st"> </span>Cs)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="primer-math.html#cb351-1"></a>Bs &lt;-<span class="st"> </span>svd.x<span class="op">$</span>U</span>
<span id="cb351-2"><a href="primer-math.html#cb351-2"></a><span class="kw">dim</span>(Bs)</span></code></pre></div>
<pre><code>## [1] 100   3</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="primer-math.html#cb353-1"></a><span class="kw">head</span>(Bs)</span></code></pre></div>
<pre><code>##            [,1]       [,2]        [,3]
## [1,] 0.06030773  0.1219884  0.06744521
## [2,] 0.02875881  0.1557010  0.14731524
## [3,] 0.05171018  0.1245243  0.09379861
## [4,] 0.14713610 -0.2998282  0.07457342
## [5,] 0.11802668  0.1086663 -0.11202975
## [6,] 0.11815965 -0.1358790  0.05620649</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="primer-math.html#cb355-1"></a><span class="kw">zapsmall</span>(<span class="kw">t</span>(Bs) <span class="op">%*%</span><span class="st"> </span>Bs)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="primer-math.html#cb357-1"></a>Cs <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(Lambda) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(Bs) <span class="op">%*%</span><span class="st"> </span>y</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 4.257054
## [2,] 1.358192
## [3,] 1.905120</code></pre>
<p>I named the diagonal matrix of singular values <code>Lambda</code> and the orthonormal matrices <code>Cs</code> and <code>Bs</code> to correspond to the <span class="math inline">\(\boldsymbol{\Lambda}, \mathbf{C}^*\)</span>, and <span class="math inline">\(\mathbf{B}^*\)</span> matrices in the text. Because <code>Lambda</code> is diagonal, its inverse is just the diagonal matrix of scalar inverses of its diagonal elements, making the computation of the the least-squares coefficients in the last line very easy, <span class="math inline">\(\mathbf{b} = \mathbf{C}^* \boldsymbol{\Lambda}^{-1} \mathbf{B}^{*\prime}\mathbf{y}\)</span>.</p>
</div>
<div id="inference-for-linear-least-squares-regression" class="section level2">
<h2><span class="header-section-number">16.28</span> Inference for Linear Least-Squares Regression</h2>
<p>To perform statistical inference for the regression, we must compute the covariance matrix of the least-squares coefficients:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="primer-math.html#cb359-1"></a>e &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span>X<span class="op">%*%</span><span class="st"> </span>b</span>
<span id="cb359-2"><a href="primer-math.html#cb359-2"></a><span class="kw">round</span>(<span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>e, <span class="dv">10</span>) <span class="co"># check = 0</span></span></code></pre></div>
<pre><code>##      [,1]
## [1,]    0
## [2,]    0
## [3,]    0</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="primer-math.html#cb361-1"></a>(s2 &lt;-<span class="st"> </span><span class="kw">as.vector</span>((<span class="kw">t</span>(e) <span class="op">%*%</span><span class="st"> </span>e)<span class="op">/</span>(<span class="dv">100</span> <span class="op">-</span><span class="st"> </span><span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] 30.0439</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="primer-math.html#cb363-1"></a>(V.b &lt;-<span class="st"> </span>s2<span class="op">*</span><span class="kw">solve</span>(<span class="kw">t</span>(X) <span class="op">%*%</span><span class="st"> </span>X))</span></code></pre></div>
<pre><code>##             [,1]        [,2]        [,3]
## [1,]  3.42138701 -0.61018570 -0.02912311
## [2,] -0.61018570  0.21726710 -0.06921412
## [3,] -0.02912311 -0.06921412  0.05754784</code></pre>
<p>Here <code>e</code> is the vector of residuals, and <code>s2</code> is the residual variance. The residuals should be orthogonal to the columns of the model matrix, and they are, within rounding error (checked here to 10 decimal places). The standard errors of the least-squares coefficients are the square-roots of the diagonal elements of <code>V.b</code>:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="primer-math.html#cb365-1"></a>(SE.b &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(V.b)))</span></code></pre></div>
<pre><code>## [1] 1.8496992 0.4661192 0.2398913</code></pre>
<p>These results match those produced by <code>lm()</code>, given above.</p>
<p>Constructing confidence intervals for the coefficients, and testing linear and nonlinear hypotheses, as described in the text, are entirely straightfoward. I’ll illustrate by showing the computation of 95% confidence intervals for the regression coefficients. We need the .975 quantile of <span class="math inline">\(t_{n - k - 1} = t_{97}\)</span>, which I obtain from the <span class="math inline">\(t\)</span> quantile function <code>qt()</code>:</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="primer-math.html#cb367-1"></a>(t &lt;-<span class="st"> </span><span class="kw">qt</span>(.<span class="dv">975</span>, <span class="dv">97</span>))</span></code></pre></div>
<pre><code>## [1] 1.984723</code></pre>
<p>The the confidence intervals are</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="primer-math.html#cb369-1"></a>CI &lt;-<span class="st"> </span><span class="kw">cbind</span>(b <span class="op">-</span><span class="st"> </span>t<span class="op">*</span>SE.b, b <span class="op">+</span><span class="st"> </span>t<span class="op">*</span>SE.b)</span>
<span id="cb369-2"><a href="primer-math.html#cb369-2"></a><span class="kw">rownames</span>(CI) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b1&quot;</span>, <span class="st">&quot;b2&quot;</span>)</span>
<span id="cb369-3"><a href="primer-math.html#cb369-3"></a><span class="kw">colnames</span>(CI) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;.025&quot;</span>, <span class="st">&quot;.975&quot;</span>)</span>
<span id="cb369-4"><a href="primer-math.html#cb369-4"></a>CI</span></code></pre></div>
<pre><code>##         .025     .975
## a  0.5859130 7.928195
## b1 0.4330745 2.283310
## b2 1.4290019 2.381238</code></pre>
<p>Checking against the standard-R <code>confint()</code> function:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="primer-math.html#cb371-1"></a><span class="kw">confint</span>(model)</span></code></pre></div>
<pre><code>##                 2.5 %   97.5 %
## (Intercept) 0.5859130 7.928195
## X1          0.4330745 2.283310
## X2          1.4290019 2.381238</code></pre>
</div>
<div id="the-elliptical-geometry-of-least-squares-regression" class="section level2">
<h2><span class="header-section-number">16.29</span> The Elliptical Geometry of Least-Squares Regression</h2>
<p>Figure 7.1 in the text shows the standard data ellipse and least-squares regression line superimposed over a scatterplot for two variables, <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. The data are artificial, and were randomly generated by independently sampling 100 <span class="math inline">\(x\)</span>-values from the uniform distribution on the interval [0, 5] and then generating the <span class="math inline">\(y\)</span> values according to the regression equation <span class="math inline">\(y_i = 1.5 + 0.5x_i + \varepsilon_i\)</span>, where the errors are independently sampled from <span class="math inline">\(N(0, \sigma^2=1)\)</span>:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="primer-math.html#cb373-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb373-2"><a href="primer-math.html#cb373-2"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb373-3"><a href="primer-math.html#cb373-3"></a>y &lt;-<span class="st"> </span><span class="fl">1.5</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">sd=</span><span class="dv">1</span>)</span>
<span id="cb373-4"><a href="primer-math.html#cb373-4"></a></span>
<span id="cb373-5"><a href="primer-math.html#cb373-5"></a><span class="kw">eqscplot</span>(x, y)</span>
<span id="cb373-6"><a href="primer-math.html#cb373-6"></a>(means &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(x), (<span class="kw">mean</span>(y))))</span></code></pre></div>
<pre><code>## [1] 2.546996 2.922409</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="primer-math.html#cb375-1"></a>V &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">cbind</span>(x, y))</span>
<span id="cb375-2"><a href="primer-math.html#cb375-2"></a>(sds &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(V)))</span></code></pre></div>
<pre><code>##        x        y 
## 1.503634 1.315754</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="primer-math.html#cb377-1"></a><span class="kw">ellipse</span>(means, V, <span class="dv">1</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb377-2"><a href="primer-math.html#cb377-2"></a>(mod.simple &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Coefficients:
## (Intercept)            x  
##      1.7955       0.4425</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="primer-math.html#cb379-1"></a><span class="kw">abline</span>(mod.simple, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb379-2"><a href="primer-math.html#cb379-2"></a><span class="kw">abline</span>(<span class="dt">v=</span>means[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>sds[<span class="dv">1</span>], <span class="dv">0</span>, sds[<span class="dv">1</span>]), </span>
<span id="cb379-3"><a href="primer-math.html#cb379-3"></a>       <span class="dt">h=</span>means[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>sds[<span class="dv">2</span>], <span class="dv">0</span>, sds[<span class="dv">2</span>]), <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-93-1.png" width="672" /></p>
<p>I use the <code>eqscplot()</code> function from the <strong>MASS</strong> package to draw the scatterplot with axes scaled to the same number of units per cm, and then the <code>ellipse()</code> function from the <strong>car</strong> package to add the standard data ellipse. Finally, I added the least-squares line and horizontal and vertical lines at the means and the means <span class="math inline">\(\pm\)</span> one standard deviation.</p>
<p>The two panels of Figure 7.2 in the text show the scatterplot and the standard data ellipse for <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, and joint confidence ellipses for the coefficients of these two explanatory variables in the regression of <span class="math inline">\(y\)</span> on the <span class="math inline">\(x\)</span>s. These graphs are for the artificially generated multiple-regression data that I saved earlier in <code>Data</code>:</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="primer-math.html#cb380-1"></a><span class="kw">head</span>(Data)</span></code></pre></div>
<pre><code>##         X1         X2         y
## 1 4.269513  3.1650539 18.332397
## 2 3.044579  0.7176396  9.216817
## 3 3.860356  2.5519196 12.767972
## 4 3.913534 12.5633334 35.288086
## 5 7.058296  7.2513218 21.187769
## 6 4.294912  9.2393562 21.754655</code></pre>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="primer-math.html#cb382-1"></a><span class="kw">dim</span>(Data)</span></code></pre></div>
<pre><code>## [1] 100   3</code></pre>
<p>The scatterplot and standard data ellipse for <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are constructed similarly to the simple-regression example for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> immediately above:</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="primer-math.html#cb384-1"></a><span class="kw">with</span>(Data, {</span>
<span id="cb384-2"><a href="primer-math.html#cb384-2"></a>  <span class="kw">eqscplot</span>(X1, X2)</span>
<span id="cb384-3"><a href="primer-math.html#cb384-3"></a>  (means &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(X1), (<span class="kw">mean</span>(X2))))</span>
<span id="cb384-4"><a href="primer-math.html#cb384-4"></a>  V &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">cbind</span>(X1, X2))</span>
<span id="cb384-5"><a href="primer-math.html#cb384-5"></a>  (sds &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(V)))</span>
<span id="cb384-6"><a href="primer-math.html#cb384-6"></a>  <span class="kw">ellipse</span>(means, V, <span class="dv">1</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb384-7"><a href="primer-math.html#cb384-7"></a>  <span class="kw">abline</span>(<span class="dt">v=</span>means[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>sds[<span class="dv">1</span>], <span class="dv">0</span>, sds[<span class="dv">1</span>]), </span>
<span id="cb384-8"><a href="primer-math.html#cb384-8"></a>         <span class="dt">h=</span>means[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>sds[<span class="dv">2</span>], <span class="dv">0</span>, sds[<span class="dv">2</span>]), <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb384-9"><a href="primer-math.html#cb384-9"></a>})</span></code></pre></div>
<p><img src="prefresher_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<p>I then use the <code>ellipse()</code> function to draw the (outer) 95% joint confidence ellipse for the population slope coefficients <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> in the regression of <span class="math inline">\(y\)</span> on <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, along with the (inner) 95% confidence-interval generating ellipse, whose shadows on the two axes are the individual 95% confidence intervals for the slopes (shown as lines at the bottom and left of the graph):
```
(b &lt;- coef(model)[2:3]) # slopes
(V &lt;- vcov(model)[2:3, 2:3]) # covariance matrix of the slopes</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="markov-chain-monte-carlo-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="confidence-ellipse.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/IQSS/prefresher/edit/master/26_primer.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["prefresher.pdf", "prefresher.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
